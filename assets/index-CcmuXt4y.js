(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const s of u.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}})();var ki=function(t){qi(t);var n=Ri(t);return t.on=n.on,t.off=n.off,t.fire=n.fire,t};function Ri(e){var t=Object.create(null);return{on:function(n,r,o){if(typeof r!="function")throw new Error("callback is expected to be a function");var u=t[n];return u||(u=t[n]=[]),u.push({callback:r,ctx:o}),e},off:function(n,r){var o=typeof n>"u";if(o)return t=Object.create(null),e;if(t[n]){var u=typeof r!="function";if(u)delete t[n];else for(var s=t[n],l=0;l<s.length;++l)s[l].callback===r&&s.splice(l,1)}return e},fire:function(n){var r=t[n];if(!r)return e;var o;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var u=0;u<r.length;++u){var s=r[u];s.callback.apply(s.ctx,o)}return e}}}function qi(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}var $r=1e-6,Ae=typeof Float32Array<"u"?Float32Array:Array;function Oi(e){Ae=e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function zi(){var e=new Ae(9);return Ae!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function _e(){var e=new Ae(16);return Ae!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Vi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function vt(e,t){var n=t[0],r=t[1],o=t[2],u=t[3],s=t[4],l=t[5],c=t[6],h=t[7],f=t[8],A=t[9],g=t[10],m=t[11],v=t[12],E=t[13],F=t[14],B=t[15],b=n*l-r*s,w=n*c-o*s,N=n*h-u*s,S=r*c-o*l,y=r*h-u*l,I=o*h-u*c,z=f*E-A*v,O=f*F-g*v,Q=f*B-m*v,V=A*F-g*E,W=A*B-m*E,Y=g*B-m*F,x=b*Y-w*W+N*V+S*Q-y*O+I*z;return x?(x=1/x,e[0]=(l*Y-c*W+h*V)*x,e[1]=(o*W-r*Y-u*V)*x,e[2]=(E*I-F*y+B*S)*x,e[3]=(g*y-A*I-m*S)*x,e[4]=(c*Q-s*Y-h*O)*x,e[5]=(n*Y-o*Q+u*O)*x,e[6]=(F*N-v*I-B*w)*x,e[7]=(f*I-g*N+m*w)*x,e[8]=(s*W-l*Q+h*z)*x,e[9]=(r*Q-n*W-u*z)*x,e[10]=(v*y-E*N+B*b)*x,e[11]=(A*N-f*y-m*b)*x,e[12]=(l*O-s*V-c*z)*x,e[13]=(n*V-r*O+o*z)*x,e[14]=(E*w-v*S-F*b)*x,e[15]=(f*S-A*w+g*b)*x,e):null}function rt(e,t,n){var r=t[0],o=t[1],u=t[2],s=t[3],l=t[4],c=t[5],h=t[6],f=t[7],A=t[8],g=t[9],m=t[10],v=t[11],E=t[12],F=t[13],B=t[14],b=t[15],w=n[0],N=n[1],S=n[2],y=n[3];return e[0]=w*r+N*l+S*A+y*E,e[1]=w*o+N*c+S*g+y*F,e[2]=w*u+N*h+S*m+y*B,e[3]=w*s+N*f+S*v+y*b,w=n[4],N=n[5],S=n[6],y=n[7],e[4]=w*r+N*l+S*A+y*E,e[5]=w*o+N*c+S*g+y*F,e[6]=w*u+N*h+S*m+y*B,e[7]=w*s+N*f+S*v+y*b,w=n[8],N=n[9],S=n[10],y=n[11],e[8]=w*r+N*l+S*A+y*E,e[9]=w*o+N*c+S*g+y*F,e[10]=w*u+N*h+S*m+y*B,e[11]=w*s+N*f+S*v+y*b,w=n[12],N=n[13],S=n[14],y=n[15],e[12]=w*r+N*l+S*A+y*E,e[13]=w*o+N*c+S*g+y*F,e[14]=w*u+N*h+S*m+y*B,e[15]=w*s+N*f+S*v+y*b,e}function ji(e,t,n){var r=n[0],o=n[1],u=n[2],s,l,c,h,f,A,g,m,v,E,F,B;return t===e?(e[12]=t[0]*r+t[4]*o+t[8]*u+t[12],e[13]=t[1]*r+t[5]*o+t[9]*u+t[13],e[14]=t[2]*r+t[6]*o+t[10]*u+t[14],e[15]=t[3]*r+t[7]*o+t[11]*u+t[15]):(s=t[0],l=t[1],c=t[2],h=t[3],f=t[4],A=t[5],g=t[6],m=t[7],v=t[8],E=t[9],F=t[10],B=t[11],e[0]=s,e[1]=l,e[2]=c,e[3]=h,e[4]=f,e[5]=A,e[6]=g,e[7]=m,e[8]=v,e[9]=E,e[10]=F,e[11]=B,e[12]=s*r+f*o+v*u+t[12],e[13]=l*r+A*o+E*u+t[13],e[14]=c*r+g*o+F*u+t[14],e[15]=h*r+m*o+B*u+t[15]),e}function Ui(e,t,n){var r=n[0],o=n[1],u=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*u,e[9]=t[9]*u,e[10]=t[10]*u,e[11]=t[11]*u,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Wi(e,t,n,r){var o=r[0],u=r[1],s=r[2],l=Math.hypot(o,u,s),c,h,f,A,g,m,v,E,F,B,b,w,N,S,y,I,z,O,Q,V,W,Y,x,M;return l<$r?null:(l=1/l,o*=l,u*=l,s*=l,c=Math.sin(n),h=Math.cos(n),f=1-h,A=t[0],g=t[1],m=t[2],v=t[3],E=t[4],F=t[5],B=t[6],b=t[7],w=t[8],N=t[9],S=t[10],y=t[11],I=o*o*f+h,z=u*o*f+s*c,O=s*o*f-u*c,Q=o*u*f-s*c,V=u*u*f+h,W=s*u*f+o*c,Y=o*s*f+u*c,x=u*s*f-o*c,M=s*s*f+h,e[0]=A*I+E*z+w*O,e[1]=g*I+F*z+N*O,e[2]=m*I+B*z+S*O,e[3]=v*I+b*z+y*O,e[4]=A*Q+E*V+w*W,e[5]=g*Q+F*V+N*W,e[6]=m*Q+B*V+S*W,e[7]=v*Q+b*V+y*W,e[8]=A*Y+E*x+w*M,e[9]=g*Y+F*x+N*M,e[10]=m*Y+B*x+S*M,e[11]=v*Y+b*x+y*M,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Gi(e,t,n){var r=Math.sin(n),o=Math.cos(n),u=t[4],s=t[5],l=t[6],c=t[7],h=t[8],f=t[9],A=t[10],g=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=u*o+h*r,e[5]=s*o+f*r,e[6]=l*o+A*r,e[7]=c*o+g*r,e[8]=h*o-u*r,e[9]=f*o-s*r,e[10]=A*o-l*r,e[11]=g*o-c*r,e}function Yi(e,t,n){var r=Math.sin(n),o=Math.cos(n),u=t[0],s=t[1],l=t[2],c=t[3],h=t[8],f=t[9],A=t[10],g=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=u*o-h*r,e[1]=s*o-f*r,e[2]=l*o-A*r,e[3]=c*o-g*r,e[8]=u*r+h*o,e[9]=s*r+f*o,e[10]=l*r+A*o,e[11]=c*r+g*o,e}function Hi(e,t,n){var r=Math.sin(n),o=Math.cos(n),u=t[0],s=t[1],l=t[2],c=t[3],h=t[4],f=t[5],A=t[6],g=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=u*o+h*r,e[1]=s*o+f*r,e[2]=l*o+A*r,e[3]=c*o+g*r,e[4]=h*o-u*r,e[5]=f*o-s*r,e[6]=A*o-l*r,e[7]=g*o-c*r,e}function Qi(e,t,n){var r=t[0],o=t[1],u=t[2],s=t[3],l=r+r,c=o+o,h=u+u,f=r*l,A=r*c,g=r*h,m=o*c,v=o*h,E=u*h,F=s*l,B=s*c,b=s*h;return e[0]=1-(m+E),e[1]=A+b,e[2]=g-B,e[3]=0,e[4]=A-b,e[5]=1-(f+E),e[6]=v+F,e[7]=0,e[8]=g+B,e[9]=v-F,e[10]=1-(f+m),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Xi(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Ki(e,t){var n=t[0],r=t[1],o=t[2],u=t[4],s=t[5],l=t[6],c=t[8],h=t[9],f=t[10];return e[0]=Math.hypot(n,r,o),e[1]=Math.hypot(u,s,l),e[2]=Math.hypot(c,h,f),e}function Sr(e,t){var n=new Ae(3);Ki(n,t);var r=1/n[0],o=1/n[1],u=1/n[2],s=t[0]*r,l=t[1]*o,c=t[2]*u,h=t[4]*r,f=t[5]*o,A=t[6]*u,g=t[8]*r,m=t[9]*o,v=t[10]*u,E=s+f+v,F=0;return E>0?(F=Math.sqrt(E+1)*2,e[3]=.25*F,e[0]=(A-m)/F,e[1]=(g-c)/F,e[2]=(l-h)/F):s>f&&s>v?(F=Math.sqrt(1+s-f-v)*2,e[3]=(A-m)/F,e[0]=.25*F,e[1]=(l+h)/F,e[2]=(g+c)/F):f>v?(F=Math.sqrt(1+f-s-v)*2,e[3]=(g-c)/F,e[0]=(l+h)/F,e[1]=.25*F,e[2]=(A+m)/F):(F=Math.sqrt(1+v-s-f)*2,e[3]=(l-h)/F,e[0]=(g+c)/F,e[1]=(A+m)/F,e[2]=.25*F),e}function Zi(e,t,n,r,o){var u=1/Math.tan(t/2),s;return e[0]=u/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(s=1/(r-o),e[10]=(o+r)*s,e[14]=2*o*r*s):(e[10]=-1,e[14]=-2*r),e}var Ji=Zi;function Tr(e,t,n,r){var o=t[0],u=t[1],s=t[2],l=r[0],c=r[1],h=r[2],f=o-n[0],A=u-n[1],g=s-n[2],m=f*f+A*A+g*g;m>0&&(m=1/Math.sqrt(m),f*=m,A*=m,g*=m);var v=c*g-h*A,E=h*f-l*g,F=l*A-c*f;return m=v*v+E*E+F*F,m>0&&(m=1/Math.sqrt(m),v*=m,E*=m,F*=m),e[0]=v,e[1]=E,e[2]=F,e[3]=0,e[4]=A*F-g*E,e[5]=g*v-f*F,e[6]=f*E-A*v,e[7]=0,e[8]=f,e[9]=A,e[10]=g,e[11]=0,e[12]=o,e[13]=u,e[14]=s,e[15]=1,e}function Mr(){var e=new Ae(3);return Ae!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function eo(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function Yu(e,t,n){var r=new Ae(3);return r[0]=e,r[1]=t,r[2]=n,r}function Hu(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function to(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function uo(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function eu(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function tu(e,t){var n=t[0],r=t[1],o=t[2],u=n*n+r*r+o*o;return u>0&&(u=1/Math.sqrt(u)),e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e}function Zt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function kt(e,t,n){var r=t[0],o=t[1],u=t[2],s=n[0],l=n[1],c=n[2];return e[0]=o*c-u*l,e[1]=u*s-r*c,e[2]=r*l-o*s,e}function Qu(e,t,n){var r=t[0],o=t[1],u=t[2],s=n[3]*r+n[7]*o+n[11]*u+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*o+n[8]*u+n[12])/s,e[1]=(n[1]*r+n[5]*o+n[9]*u+n[13])/s,e[2]=(n[2]*r+n[6]*o+n[10]*u+n[14])/s,e}function ro(e,t,n){var r=n[0],o=n[1],u=n[2],s=n[3],l=t[0],c=t[1],h=t[2],f=o*h-u*c,A=u*l-r*h,g=r*c-o*l,m=o*g-u*A,v=u*f-r*g,E=r*A-o*f,F=s*2;return f*=F,A*=F,g*=F,m*=2,v*=2,E*=2,e[0]=l+f+m,e[1]=c+A+v,e[2]=h+g+E,e}var Et=uo,no=eo;(function(){var e=Mr();return function(t,n,r,o,u,s){var l,c;for(n||(n=3),r||(r=0),o?c=Math.min(o*n+r,t.length):c=t.length,l=r;l<c;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],u(e,e,s),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();function io(){var e=new Ae(4);return Ae!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function oo(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e}function ao(e,t){var n=t[0],r=t[1],o=t[2],u=t[3],s=n*n+r*r+o*o+u*u;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=o*s,e[3]=u*s,e}function so(e,t,n){var r=t[0],o=t[1],u=t[2],s=t[3];return e[0]=n[0]*r+n[4]*o+n[8]*u+n[12]*s,e[1]=n[1]*r+n[5]*o+n[9]*u+n[13]*s,e[2]=n[2]*r+n[6]*o+n[10]*u+n[14]*s,e[3]=n[3]*r+n[7]*o+n[11]*u+n[15]*s,e}(function(){var e=io();return function(t,n,r,o,u,s){var l,c;for(n||(n=4),r||(r=0),o?c=Math.min(o*n+r,t.length):c=t.length,l=r;l<c;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],u(e,e,s),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();function Xu(){var e=new Ae(4);return Ae!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function co(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Rt(e,t,n,r){var o=t[0],u=t[1],s=t[2],l=t[3],c=n[0],h=n[1],f=n[2],A=n[3],g,m,v,E,F;return m=o*c+u*h+s*f+l*A,m<0&&(m=-m,c=-c,h=-h,f=-f,A=-A),1-m>$r?(g=Math.acos(m),v=Math.sin(g),E=Math.sin((1-r)*g)/v,F=Math.sin(r*g)/v):(E=1-r,F=r),e[0]=E*o+F*c,e[1]=E*u+F*h,e[2]=E*s+F*f,e[3]=E*l+F*A,e}function lo(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[o*3+o]&&(o=2);var u=(o+1)%3,s=(o+2)%3;r=Math.sqrt(t[o*3+o]-t[u*3+u]-t[s*3+s]+1),e[o]=.5*r,r=.5/r,e[3]=(t[u*3+s]-t[s*3+u])*r,e[u]=(t[u*3+o]+t[o*3+u])*r,e[s]=(t[s*3+o]+t[o*3+s])*r}return e}var fo=oo,Ir=ao;(function(){var e=Mr(),t=Yu(1,0,0),n=Yu(0,1,0);return function(r,o,u){var s=Zt(o,u);return s<-.999999?(kt(e,t,o),no(e)<1e-6&&kt(e,n,o),tu(e,e),co(r,e,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(kt(e,o,u),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+s,Ir(r,r))}})();(function(){var e=Xu(),t=Xu();return function(n,r,o,u,s,l){return Rt(e,r,s,l),Rt(t,o,u,l),Rt(n,e,t,2*l*(1-l)),n}})();(function(){var e=zi();return function(t,n,r,o){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=o[0],e[4]=o[1],e[7]=o[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Ir(t,lo(t,e))}})();function ho(){var e=new Ae(2);return Ae!=Float32Array&&(e[0]=0,e[1]=0),e}(function(){var e=ho();return function(t,n,r,o,u,s){var l,c;for(n||(n=2),r||(r=0),o?c=Math.min(o*n+r,t.length):c=t.length,l=r;l<c;l+=n)e[0]=t[l],e[1]=t[l+1],u(e,e,s),t[l]=e[0],t[l+1]=e[1];return t}})();class Nr{children;parent;model;worldModel;modelViewProjection;worldTransformNeedsUpdate;modelViewProjectionNeedsUpdate;type;scene;constructor(){this.children=[],this.model=_e(),this.worldModel=_e(),this.modelViewProjection=_e(),this.worldTransformNeedsUpdate=!0,this.modelViewProjectionNeedsUpdate=!0,this.type="Element",this.scene=null,this.parent=null}appendChild(t,n=!1){t.parent=this,n?this.children.unshift(t):this.children.push(t),t.bindScene&&t.bindScene(this.scene),this.scene&&this.scene.renderFrame()}insertChildAfter(t,n){t.parent=this;let r=this.children.indexOf(n);if(r<0)throw new Error("Could not find element to insert after");this.children.splice(r+1,0,t),t.bindScene&&t.bindScene(this.scene),this.scene&&this.scene.renderFrame()}bindScene(t){this.scene=t,this.worldTransformNeedsUpdate=!0,this.modelViewProjectionNeedsUpdate=!0}traverse(t,n){t(this);for(var r=0;r<this.children.length;++r){var o=this.children[r];o.traverse(t,n)}n&&n(this)}rotate(t,n){return Wi(this.model,this.model,t,n),this.worldTransformNeedsUpdate=!0,this.scene&&this.scene.renderFrame(),this}rotateX(t){return Gi(this.model,this.model,t),this.worldTransformNeedsUpdate=!0,this.scene&&this.scene.renderFrame(),this}rotateY(t){return Yi(this.model,this.model,t),this.worldTransformNeedsUpdate=!0,this.scene&&this.scene.renderFrame(),this}rotateZ(t){return Hi(this.model,this.model,t),this.worldTransformNeedsUpdate=!0,this.scene&&this.scene.renderFrame(),this}scale(t){return Ui(this.model,this.model,t),this.worldTransformNeedsUpdate=!0,this.scene&&this.scene.renderFrame(),this}translate(t){return ji(this.model,this.model,t),this.worldTransformNeedsUpdate=!0,this.scene&&this.scene.renderFrame(),this}removeChild(t){let n=this.children.indexOf(t);n>-1&&(this.children.splice(n,1),t.bindScene(null)),this.scene&&this.scene.renderFrame()}updateWorldTransform(t=!1){(this.worldTransformNeedsUpdate||t)&&(this.parent?rt(this.worldModel,this.parent.worldModel,this.model):Vi(this.worldModel,this.model),this.modelViewProjectionNeedsUpdate=!0,this.worldTransformNeedsUpdate=!1,t=!0);let n=t;for(var r=this.children,o=0;o<r.length;o++)n=r[o].updateWorldTransform(t)||n;return n}scheduleMVPUpdate(){this.modelViewProjectionNeedsUpdate=!0;let t=this.children;for(var n=0;n<t.length;n++)t[n].scheduleMVPUpdate()}updateModelViewProjection(t,n){this.modelViewProjectionNeedsUpdate&&(rt(this.modelViewProjection,t,n),rt(this.modelViewProjection,this.modelViewProjection,this.worldModel),this.modelViewProjectionNeedsUpdate=!1)}draw(t,n){for(var r=0;r<this.children.length;++r){let o=this.children[r];o.updateModelViewProjection(n.projection,n.view.matrix),o.draw(t,n)}}dispose(){for(var t=0;t<this.children.length;++t){var n=this.children[t];n.dispose()}}}const Ku={maxSingleTouchTime:300,singleTapDistanceSquared:25};function go(e,t,n){var r=Date.now();let o;return e.addEventListener("click",c,{passive:!1}),e.addEventListener("touchend",s,{passive:!1}),e.addEventListener("touchstart",u,{passive:!1}),l;function u(h){var f=h.touches;f.length===1&&(r=Date.now(),o={x:h.touches[0].pageX,y:h.touches[0].pageY})}function s(h){if(h.touches.length>1)return;var f=Date.now()-r;if(f>Ku.maxSingleTouchTime)return;let A=h.changedTouches[0];var g=A.pageX-o.x,m=A.pageY-o.y;g*g+m*m<Ku.singleTapDistanceSquared&&c(A)}function l(){e.removeEventListener("click",c),e.removeEventListener("touchend",s),e.removeEventListener("touchstart",u)}function c(h){t.call(n,h)}}let Ao=[0,0,0];const mo=[1,0,0],vo=[0,1,0],Eo=[0,0,1];class po{matrix;cameraWorld;position;orientation;center;constructor(t){this.matrix=t||_e(),this.cameraWorld=vt(_e(),this.matrix),this.position=[0,0,0],this.orientation=[0,0,0,1],this.center=[0,0,0],this.deconstructPositionRotation()}lookAt(t,n,r){return Tr(this.cameraWorld,t,n,r),vt(this.matrix,this.cameraWorld),this.deconstructPositionRotation(),this}update(){return Qi(this.cameraWorld,this.orientation,this.position),vt(this.matrix,this.cameraWorld),this}deconstructPositionRotation(){Xi(this.position,this.cameraWorld),Sr(this.orientation,this.cameraWorld)}translateOnAxis(t,n){let r=ro(Ao,t,this.orientation);return eu(this.position,this.position,r,n),this}translateX(t){return this.translateOnAxis(mo,t)}translateY(t){return this.translateOnAxis(vo,t)}translateZ(t){return this.translateOnAxis(Eo,t)}}var yt={exports:{}},Co=4,Fo=.001,yo=1e-7,Bo=10,ut=11,ct=1/(ut-1),Do=typeof Float32Array=="function";function Pr(e,t){return 1-3*t+3*e}function Lr(e,t){return 3*t-6*e}function _r(e){return 3*e}function Ct(e,t,n){return((Pr(t,n)*e+Lr(t,n))*e+_r(t))*e}function kr(e,t,n){return 3*Pr(t,n)*e*e+2*Lr(t,n)*e+_r(t)}function wo(e,t,n,r,o){var u,s,l=0;do s=t+(n-t)/2,u=Ct(s,r,o)-e,u>0?n=s:t=s;while(Math.abs(u)>yo&&++l<Bo);return s}function xo(e,t,n,r){for(var o=0;o<Co;++o){var u=kr(t,n,r);if(u===0)return t;var s=Ct(t,n,r)-e;t-=s/u}return t}function bo(e){return e}var $o=function(t,n,r,o){if(!(0<=t&&t<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===n&&r===o)return bo;for(var u=Do?new Float32Array(ut):new Array(ut),s=0;s<ut;++s)u[s]=Ct(s*ct,t,r);function l(c){for(var h=0,f=1,A=ut-1;f!==A&&u[f]<=c;++f)h+=ct;--f;var g=(c-u[f])/(u[f+1]-u[f]),m=h+g*ct,v=kr(m,t,r);return v>=Fo?xo(c,m,t,r):v===0?m:wo(c,h,h+ct,t,r)}return function(h){return h===0?0:h===1?1:Ct(l(h),n,o)}},Je=$o,Zu={ease:Je(.25,.1,.25,1),easeIn:Je(.42,0,1,1),easeOut:Je(0,0,.58,1),easeInOut:Je(.42,0,.58,1),linear:Je(0,0,1,1)};yt.exports=So;yt.exports.makeAggregateRaf=Rr;yt.exports.sharedScheduler=Rr();function So(e,t,n){var r=Object.create(null),o=Object.create(null);n=n||{};var u=typeof n.easing=="function"?n.easing:Zu[n.easing];u||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),u=Zu.ease);var s=typeof n.step=="function"?n.step:Ju,l=typeof n.done=="function"?n.done:Ju,c=To(n.scheduler),h=Object.keys(t);h.forEach(function(B){r[B]=e[B],o[B]=t[B]-e[B]});var f=typeof n.duration=="number"?n.duration:400,A=Math.max(1,f*.06),g,m=0;return g=c.next(E),{cancel:v};function v(){c.cancel(g),g=0}function E(){var B=u(m/A);m+=1,F(B),m<=A?(g=c.next(E),s(e)):(g=0,setTimeout(function(){l(e)},0))}function F(B){h.forEach(function(b){e[b]=o[b]*B+r[b]})}}function Ju(){}function To(e){if(!e){var t=typeof window<"u"&&window.requestAnimationFrame;return t?Mo():Io()}if(typeof e.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof e.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return e}function Mo(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function Io(){return{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}function Rr(){var e=new Set,t=new Set,n=0;return{next:o,cancel:o,clearAll:r};function r(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}function o(l){t.add(l),u()}function u(){n||(n=requestAnimationFrame(s))}function s(){n=0;var l=t;t=e,e=l,e.forEach(function(c){c()}),e.clear()}}function er(e,t,n){typeof n!="object"&&(n={});let r=.001,o=typeof n.minVelocity=="number"?n.minVelocity:r,u=typeof n.amplitude=="number"?n.amplitude:.01,s=typeof n.cancelAnimationFrame=="function"?n.cancelAnimationFrame:No(),l=typeof n.requestAnimationFrame=="function"?n.requestAnimationFrame:Po(),c,h,f=342,A,g,m,v,E,F,B,b;return{start:y,setAmplitude:w,getAmplitude:N,stop:z,impulse:O,cancel:S};function w(V){u=V}function N(){return u}function S(){s(A),s(b)}function y(){c=e(),m=E=g=v=F=0,h=new Date,s(A),s(b),A=l(I)}function I(){var V=Date.now(),W=V-h;h=V;var Y=e(),x=Y.x-c.x,M=Y.y-c.y,q=(Y.z||0)-c.z;c=Y;var D=1e3/(1+W);g=.8*x*D+.2*g,v=.8*M*D+.2*v,F=.8*q*D+.2*F,A=l(I)}function z(){A&&(s(A),A=0,s(b),b=0,O(g,v,F))}function O(V,W,Y){h=Date.now(),(V<-o||V>o)&&(m=u*V),(W<-o||W>o)&&(E=u*W),(Y<-o||Y>o)&&(B=u*Y),b=l(Q)}function Q(){var V=Date.now()-h,W=!1,Y=0,x=0,M=0;let q=Math.exp(-V/f);if(m&&(Y=m*q,Y>r||Y<-r?W=!0:Y=m=0),E&&(x=E*q,x>r||x<-r?W=!0:x=E=0),B&&(M=B*q,M>r||M<-r?W=!0:M=B=0),W){let D=e();t(D.x+Y,D.y+x,D.z+M),b=l(Q)}}}function No(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function Po(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(e){return setTimeout(e,16)}}class Lo{x;y;lastX;lastY;id;createdAt;constructor(t){this.x=t.clientX,this.y=t.clientY,this.lastX=this.x,this.lastY=this.y,this.id=t.identifier,this.createdAt=Date.now()}move(t){this.lastX=this.x,this.lastY=this.y,this.x=t.clientX,this.y=t.clientY}}const lt=0,_o=1,ko=2,Ro=3;class qo{allowRotation;state;canRotate;canScale;canIncline;first;second;stateChanged;constructor(t){this.allowRotation=t,this.state=lt,this.canRotate=!1,this.canScale=!1,this.canIncline=!1,this.first=void 0,this.second=void 0,this.stateChanged=!1}reset(){this.state=lt,this.canRotate=!1,this.canScale=!1,this.canIncline=!1,this.first=void 0,this.second=void 0}isUnknown(){return this.state===lt}track(t,n){if(this.stateChanged=!1,this.state!==lt)return;if(!(this.first&&this.second)){this.first={id:t.id,x:t.x,y:t.y},this.second={id:n.id,x:n.x,y:n.y};return}let r=this.first,o=this.second;if(t.id===o.id&&n.id===r.id){let v=r;r=o,o=v}let u=r.y-o.y,s=r.x-o.x,l=t.y-n.y,c=t.x-n.x,h=Math.abs(Math.hypot(u,s)-Math.hypot(l,c)),f=Math.atan2(u,s),A=Math.abs(f-Math.atan2(l,c));f=Math.abs(f)*180/Math.PI;let g=60;if((f<g||180-f<g)&&this.allowRotation&&Math.abs(t.createdAt-n.createdAt)<100){let v=t.x-r.x+n.x-o.x,E=t.y-r.y+n.y-o.y;Math.abs(v)<10&&Math.abs(E)>42&&(this.canIncline=!0)}this.canIncline?(this.canRotate=!1,this.canScale=!1,this.canIncline=!0,this.state=Ro):A>.1&&this.allowRotation?(this.canRotate=!0,this.canScale=!0,this.canIncline=!1,this.state=ko):h>15&&(this.canRotate=!1,this.canScale=!0,this.canIncline=!1,this.state=_o),this.stateChanged=!0}}function Oo(e,t){let n=!1,r=new Map,{allowRotation:o,allowPinchRotation:u,panAnimation:s,rotateAnimation:l}=t,c=new qo(u&&o),h,f=Date.now(),A=f;return m(),{dispose:g};function g(){e.removeEventListener("touchstart",v,{passive:!1}),b()}function m(){e.addEventListener("touchstart",v,{passive:!1})}function v(w){n||(B(),n=!0),s.cancel(),l.cancel(),w.touches.length===1&&s.start();for(let N=0;N<w.touches.length;++N){let S=w.touches[N];r.has(S.identifier)||r.set(S.identifier,new Lo(S))}w.stopPropagation(),w.preventDefault()}function E(w){let N=Date.now(),S=0,y=0,I=0,z=0,O,Q,V=!1,W=w.touches;for(let q=0;q<W.length;++q){let D=W[q],P=r.get(D.identifier);P&&(P.move(D),I+=P.x,z+=P.y,S+=P.x-P.lastX,y+=P.y-P.lastY,O?Q||(Q=P):O=P)}let Y=W.length;if(S/=Y,y/=Y,I/=Y,z/=Y,Q||c.reset(),O&&Q){A=N;let q=Q.x-O.x,D=Q.y-O.y,P=Q.lastX-O.lastX,U=Q.lastY-O.lastY,K=Math.hypot(q,D)/Math.hypot(P,U)-1,ue=Math.atan2(D,q)-Math.atan2(U,P);if(c.track(O,Q),c.stateChanged&&(l.start(),s.cancel()),c.canScale&&(t.zoomToClientCoordinates(I,z,K),V=!0),c.canRotate&&(t.rotateByAngle(ue,0),V=!0),c.canIncline){let ne=Q.y-Q.lastY+O.y-O.lastY;t.rotateByAbsoluteOffset(0,ne),V=!0}w.preventDefault(),w.stopPropagation()}let x=N-f,M=c.canIncline||x<300||w.touches.length>1&&c.isUnknown();(S!==0||y!==0)&&!M&&(t.panByAbsoluteOffset(S,y),V=!0),V&&t.redraw()}function F(w){let N=Date.now(),S=N-f;f=N;let y=w.changedTouches;for(let I=0;I<y.length;++I){let z=y[I];r.delete(z.identifier)}if(w.touches.length<2&&(c.reset(),l.stop(),s.stop()),w.touches.length===0&&r.clear(),r.size===0&&w.changedTouches.length===1){if(n=!1,b(),s.stop(),S<350&&N-A>350){let I=w.changedTouches[0],z=Math.abs(I.clientX-h.clientX),O=Math.abs(I.clientY-h.clientY);Math.hypot(z,O)<30&&t.zoomToClientCoordinates(h.clientX,h.clientY,.5,!0)}h=w.changedTouches[0]}}function B(){document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("touchend",F,{passive:!1}),document.addEventListener("touchcancel ",F,{passive:!1})}function b(){document.removeEventListener("touchmove",E),document.removeEventListener("touchend",F),document.removeEventListener("touchcancel ",F)}}function tr(e,t,n){let r=e*Math.cos(t),o=e*Math.sin(t)*Math.cos(n),u=e*Math.sin(t)*Math.sin(n);return[o,u,r]}function Ee(e,t,n){return e<t&&(e=t),e>n&&(e=n),e}function Ge(e,t){return e===void 0?t:e}function Ye(e,t,n){return Math.abs(e)<t?n:e}function zo(e,t){let n=0,r=0,o=0,u=0,s=0,l=0,c=0,h=0,f=0,A=0,g=0,m=0,v=0;return E(),{dispose:F};function E(){e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),e.addEventListener("keydown",w),e.addEventListener("keyup",N)}function F(){e.removeEventListener("keydown",w),e.removeEventListener("keyup",N),cancelAnimationFrame(n)}function B(){n=0;let y=.9,I=!1;if(s=Ye(s*y+r,.5,0),l=Ye(l*y+o,.5,0),c=Ye(c*y+u,.5,0),(s||l)&&(t.panByAbsoluteOffset(s,l),I=!0),c&&(t.slideCenterUpDown(c),I=!0),h=Ye(h*y+f/2,Math.PI/360,0),m=Ye(m*y+v/6,Math.PI/360,0),(h||m)&&(t.rotateByAbsoluteOffset(h,m),I=!0),A=Ye(A*.7+g,.5,0),A){let z=Math.sign(A)*.025;t.zoomCenterByScaleFactor(z,0,0),I=!0}I&&(t.redraw(),b())}function b(){n||(n=requestAnimationFrame(B))}function w(y){S(y,1)}function N(y){S(y,0)}function S(y,I){if(!Vo(y)){switch(y.which){case 81:f=-I;break;case 69:f=I;break;case 187:g=I;break;case 189:g=-I;break;case 82:v=I;break;case 70:v=-I;break;case 37:case 65:r=I;break;case 39:case 68:r=-I;break;case 38:case 87:o=I;break;case 40:case 83:o=-I;break;case 71:u=-I;break;case 84:u=I;break}b()}}}function Vo(e){return e.altKey||e.ctrlKey||e.metaKey}function jo(e,t){let n,r,o,{allowRotation:u,panAnimation:s,rotateAnimation:l}=t;return e.addEventListener("wheel",m,{passive:!1}),e.addEventListener("mousedown",h,{passive:!1}),e.addEventListener("dblclick",g,{passive:!1}),{dispose:c};function c(){e.removeEventListener("wheel",m,{passive:!1}),e.removeEventListener("mousedown",h,{passive:!1}),e.removeEventListener("dblclick",g,{passive:!1}),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",A)}function h(E){(E.button===1&&window.event!==null||E.button===0)&&(document.addEventListener("mousemove",f),document.addEventListener("mouseup",A),n=E.clientX,r=E.clientY,o=E.altKey&&u,s.cancel(),l.cancel(),o?l.start():s.start())}function f(E){let F=E.clientY-r,B=E.clientX-n;o?t.rotateByAbsoluteOffset(B,F):t.panByAbsoluteOffset(B,F),n=E.clientX,r=E.clientY,t.redraw()}function A(){document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",A),o?l.stop():s.stop()}function g(E){t.zoomToClientCoordinates(E.clientX,E.clientY,.5,!0),E.preventDefault(),E.stopPropagation()}function m(E){let F=E.deltaMode>0?100:1,B=v(-E.deltaY*F);t.zoomToClientCoordinates(E.clientX,E.clientY,B),E.preventDefault()}function v(E){return Math.sign(E)*Math.min(.25,Math.abs(E/128))}}function qr(e,t){if(typeof e=="string"){let n=document.querySelector(e);if(!n)throw new Error("Cannot resolve input target element: "+e);return n}return e||t}class Uo{drawContext;updated;constructor(t){this.drawContext=t.getDrawContext(),this.updated=!1}}function Wo(e){const t=e.getDrawContext();let n=t.view,r=Math.PI*2,o=Math.PI*1.618,u=new Uo(e),s=e.getOptions()||{},l=s.allowRotation===void 0?!0:!!s.allowRotation,c=s.allowPinchRotation===void 0?l:!!s.allowPinchRotation,h=Ge(s.minPhi,-1/0),f=Ge(s.maxPhi,1/0),A=Ee(-Math.PI/2,h,f),g=Ge(s.minTheta,0),m=Ge(s.maxTheta,Math.PI),v=Ee(0,g,m),E=Ge(s.minZoom,-1/0),F=Ge(s.maxZoom,1/0),B=Ee(1,E,F),b=n.center,w=n.position,N=er(ue,H),S=er(ne,fe,{minVelocity:1}),y=[0,0,1];const I={dispose:Y,setViewBox:W,panByAbsoluteOffset:D,slideCenterUpDown:K,rotateByAngle:M,rotateByAbsoluteOffset:q,zoomCenterByScaleFactor:j,zoomToClientCoordinates:P,redraw:L,allowRotation:l,allowPinchRotation:c,rotateAnimation:S,panAnimation:N},z=qr(s.inputTarget,t.canvas),O=zo(z,I),Q=Oo(z,I),V=jo(z,I);return L(),I;function W(){return w=n.position,B=Math.hypot(w[2]),b[0]=w[0],b[1]=w[1],b[2]=0,v=Ee(0,g,m),A=Ee(-Math.PI/2,h,f),L(),I}function Y(){S.cancel(),N.cancel(),Q.dispose(),O.dispose(),V.dispose()}function x(k,G){let Z=e.getSceneCoordinate(k,G),re=Et(Z,Z,w);tu(re,re);let ie=Zt(y,re);if(Math.abs(ie)>1e-7){let le=Zt(Et([0,0,0],b,w),y)/ie;return eu([0,0,0],w,re,le)}}function M(k,G){A=Ee(A+k,h,f),v=Ee(v+G,g,m)}function q(k,G){if(!l)return;let Z=t.width/t.height;A-=r*k/t.width,v-=o*G/t.height*Z,v=Ee(v,g,m),A=Ee(A,h,f)}function D(k,G){let Z=t.width/t.height,re=2*B*Math.tan(t.fov/2),ie=Z*re*k/(t.width/t.pixelRatio),le=re*G/(t.height/t.pixelRatio);U(ie,-le)}function P(k,G,Z,re){let ie=x(k,G);if(!ie)return;let le=ie[0]-b[0],we=ie[1]-b[1];if(re){let Ie={r:B,x:b[0],y:b[1]},J={r:Ee(B*(1-Z),E,F),x:Ie.x+le*Z,y:Ie.y+we*Z};yt.exports(Ie,J,{step(oe){B=oe.r,b[0]=oe.x,b[1]=oe.y,L()}})}else j(Z,le,we),L()}function U(k,G){let Z=Math.cos(A),re=Math.sin(A);b[0]+=Z*G+re*k,b[1]+=re*G-Z*k}function K(k){b[2]+=k*B*.001}function ue(){return{x:b[0],y:b[1],z:b[2]}}function ne(){return{x:A,y:v,z:0}}function fe(k,G){v=Ee(G,g,m),A=Ee(k,h,f),L()}function H(k,G,Z){Hu(b,k,G,Z),L()}function j(k,G,Z){let re=Ee(B*(1-k),E,F);re!==B&&(B=re,b[0]+=G*k,b[1]+=Z*k)}function L(){let k=tr(B,v,A),G=Math.hypot(B,1),Z=v-Math.acos(B/G),re=tr(G,Z,A);if(Et(re,re,k),Hu(w,k[0],k[1],k[2]),to(w,w,b),Tr(n.cameraWorld,w,b,re),Sr(n.orientation,n.cameraWorld),n.update(),u.updated=!1,e.fire("transform",u),u.updated){L();return}e.getRoot().scheduleMVPUpdate(),e.renderFrame()}}function Go(e){const{x:t,y:n,z:r,view:o,cameraController:u,renderFrame:s,cancelFrameToken:l,requestFrameToken:c}=e,h=e.durationMs!==void 0?e.durationMs:500;if(h<=0){o.position[0]=t,o.position[1]=n,r!==void 0&&(o.position[2]=r),o.update(),u&&u.setViewBox&&u.setViewBox({left:t-.5,right:t+.5,top:n+.5,bottom:n-.5}),s(),e.done&&e.done();return}const f=o.position[0],A=o.position[1],g=o.position[2],m=t,v=n,E=r!==void 0?r:g,F=Yo(e.easing||"easeInOutCubic"),B=Date.now(),b=B+h;l(),w();function w(){const N=Date.now();if(N>=b){o.position[0]=m,o.position[1]=v,o.position[2]=E,o.update(),u&&u.setViewBox&&u.setViewBox({left:m-.5,right:m+.5,top:v+.5,bottom:v-.5}),s(!0),e.done&&e.done();return}const S=F((N-B)/h),y=f+S*(m-f),I=A+S*(v-A),z=g+S*(E-g);o.position[0]=y,o.position[1]=I,o.position[2]=z,o.update(),u&&u.setViewBox&&u.setViewBox({left:y-.5,right:y+.5,top:I+.5,bottom:I-.5}),s(!0),c(w)}}function Yo(e){const t={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>n*(2-n),easeInOutQuad:n=>n<.5?2*n*n:-1+(4-2*n)*n,easeInCubic:n=>n*n*n,easeOutCubic:n=>--n*n*n+1,easeInOutCubic:n=>n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1};return t[e]||t.easeInOutCubic}Oi(Float64Array);function Ho(e,t={}){let n,r,o=t.devicePixelRatio||window.devicePixelRatio,u=t.wglContextOptions,s=e.getContext(t.version===2?"webgl2":"webgl",u)||e.getContext("experimental-webgl",u);s.enable(s.BLEND),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);let l=0,c=new Nr,h=!1,f=!1,A=qr(t.inputTarget,e),g,m=new po,v=_e(),E=_e(),F=t.fov===void 0?Math.PI*45/180:t.fov,B=t.near===void 0?.01:t.near,b=t.far===void 0?1/0:t.far;const w={width:window.innerWidth,height:window.innerHeight,pixelRatio:o,canvas:e,projection:v,inverseProjection:E,view:m,fov:F};ne();let N=ki({appendChild:ie,getSceneCoordinate:j,getClientCoordinate:L,getTransform:q,getRoot:Y,getGL:W,removeChild:le,setViewBox:k,setClearColor:D,getClearColor:P,clear:re,dispose:K,renderFrame:G,flyTo:Ie,getPixelRatio:z,setPixelRatio:V,updateCanvasSize:ne,getCameraController:M,setCameraController:x,getDrawContext:O,getOptions:Q}),S=N.on;N.on=we,c.bindScene(N);let y=(t.controls||Wo)(N),I;return U(),G(),N;function z(){return o}function O(){return w}function Q(){return t}function V(J){o=J,w.pixelRatio=o,ne()}function W(){return s}function Y(){return c}function x(J){return y&&y.dispose(),y=J(N,w),y}function M(){return y}function q(){return c.model}function D(J,oe,pe,me){s.clearColor(J,oe,pe,me)}function P(){return s.getParameter(s.COLOR_CLEAR_VALUE)}function U(){A.addEventListener("mousemove",H),I=go(A,fe),window.addEventListener("resize",ue,!0)}function K(){A.removeEventListener("mousemove",H),I&&I(),window.removeEventListener("resize",ue,!0),y.dispose(),c.dispose(),l&&(cancelAnimationFrame(l),l=0)}function ue(){ne()}function ne(){t.size?(n=e.width=t.size.width,r=e.height=t.size.height):(n=e.width=e.offsetWidth*o,r=e.height=e.offsetHeight*o),g=e.getBoundingClientRect(),s.viewport(0,0,n,r),w.width=n,w.height=r,c.worldTransformNeedsUpdate=!0,Ji(v,F,n/r,B,b),vt(E,v),G()}function fe(J){if(h){var oe=j(J.clientX,J.clientY);oe&&N.fire("click",{originalEvent:J,x:oe[0],y:oe[1],z:oe[2]})}}function H(J){if(f){var oe=j(J.clientX,J.clientY);oe&&N.fire("mousemove",{originalEvent:J,x:oe[0],y:oe[1],z:oe[2]})}}function j(J,oe){J-=g.left,oe-=g.top;var pe=N.getPixelRatio();let me=pe*J/n*2-1,xe=(1-pe*oe/r)*2-1,ge=Qu([0,0,0],[me,xe,0],E);Qu(ge,ge,m.cameraWorld),Et(ge,ge,m.position),tu(ge,ge);var Ze=0,Bt=(Ze-m.position[2])/ge[2];return ge[2]>0,eu(ge,m.position,ge,Bt),ge}function L(J,oe,pe=0){var me=rt(_e(),v,m.matrix);rt(me,me,c.model);var xe=so([0,0,0,0],[J,oe,pe,1],me),Ke=N.getPixelRatio(),ge=n*(xe[0]/xe[3]+1)*.5/Ke,Ze=r*(1-(xe[1]/xe[3]+1)*.5)/Ke;return{x:ge,y:Ze}}function k(J){const pe=w.pixelRatio*Math.max((J.top-J.bottom)/2,(J.right-J.left)/2),{position:me,orientation:xe}=w.view;me[0]=(J.left+J.right)/2,me[1]=(J.top+J.bottom)/2,me[2]=pe/Math.tan(w.fov/2),fo(xe,0,0,0,1),w.view.update(),y.setViewBox&&y.setViewBox(J)}function G(J=!1){if(J)return Z();l||(l=requestAnimationFrame(Z))}function Z(){s.clear(s.COLOR_BUFFER_BIT),c.updateWorldTransform(),c.draw(s,w),l=0}function re(){s.clear(s.COLOR_BUFFER_BIT)}function ie(J,oe=!1){c.appendChild(J,oe),N.fire("append-child",J)}function le(J){c.removeChild(J),N.fire("remove-child",J)}function we(J,oe,pe){return J==="click"&&(h=!0),J==="mousemove"&&(f=!0),S(J,oe,pe)}function Ie(J){if(!J||typeof J.x!="number"||typeof J.y!="number")throw new Error("flyTo requires at minimum x and y coordinates");return y&&y.flyTo?y.flyTo(J):Go({...J,view:m,cameraController:y,renderFrame:G,cancelFrameToken:()=>{l&&(cancelAnimationFrame(l),l=0)},requestFrameToken:oe=>requestAnimationFrame(oe)})}}const Qo={mat4:"uniformMatrix4fv",mat3:"uniformMatrix3fv",mat2:"uniformMatrix2fv",vec4:"uniform4fv",vec3:"uniform3fv",vec2:"uniform2fv",float:"uniform1f",bool:"uniform1i",int:"uniform1i"};class Xo{name;functionName;location;constructor(t,n){let r=Qo[n];if(!r)throw new Error("Function name for uniform is required");this.name=t,this.functionName=r,this.location=`${this.name}UniformLocation`}getInitBlockForDraw(){return`let ${this.location} = gl.getUniformLocation(program, '${this.name}');`}getDraw(){return this.functionName.indexOf("Matrix")>-1?`gl.${this.functionName}(${this.location}, false, uniforms.${this.name});`:`gl.${this.functionName}(${this.location}, uniforms.${this.name});`}}class Jt{name;offset;variableName;ready;location;isTexture;constructor(t,n=0){this.name=t,this.offset=n,this.variableName=`${t}Texture`,this.ready=`${this.variableName}Ready`,this.location=`${this.name}UniformLocation`,this.isTexture=!0}getInitBlockForDraw(){return`
  let ${this.location} = gl.getUniformLocation(program, '${this.name}');
  let ${this.variableName} = gl.createTexture();
  let ${this.ready} = false;
`}getTextureInitCanvasBlock(){return`
  gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
  gl.bindTexture(gl.TEXTURE_2D, ${this.variableName});
  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
  gl.bindTexture(gl.TEXTURE_2D, null);
  ${this.ready} = true`}getDraw(){return`
    gl.activeTexture(gl.TEXTURE${this.offset});
    gl.bindTexture(gl.TEXTURE_2D, ${this.variableName});
    gl.uniform1i(${this.location}, ${this.offset});
`}}class uu{type;debug;bufferViewType;count;name;bytePerElement;constructor(){this.type="gl.FLOAT",this.debug=!1,this.bufferViewType="Float32Array",this.count=1,this.name=void 0,this.bytePerElement=4}setName(t){this.name=t}getInitBlockForBuffer(t){return this.ensureNameIsSet(),`${t?"let ":""}${this.name}Array = new ${this.bufferViewType}(buffer);`}getInitBlockForDraw(){this.ensureNameIsSet();let{name:t}=this;return`let ${t}AttributeLocation = gl.getAttribLocation(program, '${t}');`}getAddBlock(t,n){throw new Error("Concrete types have to implement this")}getMoveBlock(t,n){throw new Error("Concrete type have to implement `getMoveBlock`")}getGetBlock(t){throw new Error("Concrete types have to implement `getGetBlock`")}getDivisor(t){this.ensureNameIsSet();let n=`${this.name}AttributeLocation`;return`if (${n} > -1) gle.vertexAttribDivisorANGLE(${n}, ${t});`}getDraw(t,n){this.ensureNameIsSet();let r=`${this.name}AttributeLocation`;return`
    gl.enableVertexAttribArray(${r});
    gl.vertexAttribPointer(${r}, ${this.count}, ${this.type}, false, ${t}, ${n});`}ensureNameIsSet(){if(!this.name)throw new Error("You have to call setName() before using attributes")}}class qt extends uu{constructor(t){super(),this.count=t}getAddBlock(t,n=`
`){let r=this.name,o=`${r}Array`,u=[];this.debug&&u.push(`if (item.${r} === undefined) throw new Error('Attribute "${r}" is missing');
`);for(let s=0;s<this.count;++s){let l=`item.${r}[${s}]`;this.debug&&u.push(`if (${l} === undefined) throw new Error('Attribute "${r}" is missing value at index ${s}');
`),u.push(`${o}[index + ${t+s}] = ${l};`)}return{code:u.join(n),offset:t+this.count}}getMoveBlock(t,n=`
`){let o=`${this.name}Array`,u=[];for(let s=0;s<this.count;++s)u.push(`${o}[to + ${t+s}] = ${o}[from + ${t+s}];`);return u.join(n)}getGetBlock(t){let n=`${this.name}Array`,r=[];for(let o=0;o<this.count;++o)r.push(`${n}[index + ${t+o}]`);return`${this.name}: [${r.join(", ")}]`}}class Ko extends uu{getAddBlock(t){let n=this.name,r=`${n}Array`,o="";return this.debug&&(o=`if (item.${n} === undefined) throw new Error('Attribute "${n}" is missing');`),o+=`${r}[index + ${t}] = item.${n};`,{code:o,offset:t+this.count}}getMoveBlock(t,n=`
`){let o=`${this.name}Array`,u="";return u+=`${o}[to + ${t}] = ${o}[from + ${t}];${n}`,u}getGetBlock(t){return`${this.name}: ${this.name}Array[index + ${t}]`}}const ur={vec4:()=>new qt(4),vec3:()=>new qt(3),vec2:()=>new qt(2),float:()=>new Ko};function Zo(e,t){let n=[],r=[],o=Jo(e.vertex,e.fragment,t);o.attributes.forEach(h=>{const{name:f,type:A}=h;let g=e.attributes&&e.attributes[f];if(!g&&typeof ur[A]=="function"&&(g=ur[A]()),!g)throw console.error(`Unknown type ${A} for ${f}`),new Error(`Unknown type ${A} for ${f}`);g.debug=e&&e.debug||!1,g.setName(f);let m=e.instanced&&e.instanced[f];m?(m.setTypeDefinition(g),r.push(m)):n.push(g)});let u=[],s=0;o.uniforms.forEach(h=>{const f=h.name;h.type==="sampler2D"?u.push(new Jt(f,s++)):u.push(new Xo(f,h.type))});let l=0,c=0;if(n.forEach(h=>{c+=h.count,l+=h.count*h.bytePerElement}),e.attributeLayout){let h=new Map;e.attributeLayout.forEach((f,A)=>h.set(f,A)),n.sort((f,A)=>h.get(f.name)-h.get(A.name))}return{bytePerVertex:l,itemPerVertex:c,attributes:n,instanced:r,uniforms:u}}function Jo(e,t,n){let r=n?/in\s+(.+);/:/attribute\s+(.+);/,o=/uniform\s+(.+);/,u=[],s=[];return e.split(`
`).forEach(c=>{let h=c.match(r);if(h&&!c.trim().startsWith("//")){l(h[1],u);return}let f=c.match(o);if(f&&!c.trim().startsWith("//")){l(f[1],s);return}}),t.split(`
`).forEach(c=>{let h=c.match(o);h&&l(h[1],s)}),{attributes:u,uniforms:s};function l(c,h){let f=c.replace(/,/g," ").split(" ").filter(g=>g),A=f[0];for(let g=1;g<f.length;++g){let m=f[g];h.find(v=>v.name===m)||h.push({type:A,name:m})}}}class ea{api;init;bufferInit;implementation;attributesDrawBlock;constructor(){this.api=[],this.init=[],this.implementation=[],this.bufferInit=[]}addToInit(t){t&&this.init.push(t)}addBufferInit(t){t&&this.bufferInit.push(t)}addToAPI(t){t&&this.api.push(t)}addToImplementation(t){t&&this.implementation.push(t)}setAttributesDrawBlock(t){this.attributesDrawBlock=t}link(){let t=[];return this.init.forEach(n),n("  return {"),this.api.forEach(n),n("  };"),this.implementation.forEach(n),t.join(`
`);function n(r){Array.isArray(r)?t.push(r.join(`
    `)):t.push(r)}}}function ru(e){let t=e.gl,n=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext,r=Zo(e,n),o=w(e.vertex,e.fragment),u=e.preDrawHook||rr,s=e.postDrawHook||rr,l=f(r),c=l.link(),h=new Function("gl","program",c)(t,o);return e.debug&&(console.log("Compiled code: "),console.log(c)),h.getCode=()=>l,h.dispose=()=>{t.deleteProgram(o)},h;function f(S){let y=new ea;return E(S,y),e.sourceBuffer?A(S,y):(F(S,y),g(S,y)),m(S,y),v(S,y),y}function A(S,y){y.addToInit(["let glBuffer;",""]),y.addToAPI(["setGLBuffer: (newBuffer) => glBuffer = newBuffer,"])}function g(S,y){y.addToInit(["let glBuffer = gl.createBuffer();","if (!glBuffer) throw new Error('failed to create a WebGL buffer');",""]),y.addToAPI(["getGLBuffer: () => glBuffer,"])}function m(S,y){let{uniforms:I}=S,z=[];if(I.forEach(V=>{V instanceof Jt&&z.push(V)}),!z.length)return;y.addToAPI("setTextureCanvas: setTextureCanvas,");let O=z.map(V=>`
      case '${V.name}': {
        ${V.getTextureInitCanvasBlock()}
        return;
      }
      `);y.addToImplementation(`
  function setTextureCanvas(textureName, textureCanvas) {
    switch(textureName) {
      ${O.join(`
      `)}
    }
    throw new Error('Unknown texture name: ' + textureName);
  }
`);const Q=z.map(V=>`case '${V.name}': return ${V.variableName};`);y.addToAPI("getTextureByName: getTextureByName,"),y.addToImplementation(`
  function getTextureByName(textureName) {
    switch(textureName) {
      ${Q.join(`
      `)}
    }
    throw new Error('Unknown texture name: ' + textureName);
  }
`)}function v(S,y){let{attributes:I,instanced:z,uniforms:O,bytePerVertex:Q,itemPerVertex:V}=S,W=e.sourceBuffer&&e.sourceBuffer.getCode();W?(y.addToInit(W.bufferInit),y.addBufferInit(W.bufferInit)):I.forEach(q=>{let D="  "+q.getInitBlockForDraw();y.addToInit(D),y.addBufferInit(D)});let Y=[];O.forEach(q=>{y.addToInit("  "+q.getInitBlockForDraw()),q instanceof Jt&&Y.push(q)}),z.length&&(y.addToInit(`  let gle = gl.getExtension('ANGLE_instanced_arrays');
  if (!gle) {
    // Not sure if this is going to be an error, given instancing is widely supported. But
    // If you get this error please ping me so that we can find a fallback solution
    throw new Error('Instanced collection requires instancing support. Please ping @anvaka so that we can add fallback');
  }
`),z.forEach(q=>{y.addToInit("  "+q.getInitBlock())}));let x=[];if(W)x=W.attributesDrawBlock;else{let q=0;I.forEach(D=>{x.push(D.getDraw(Q,q)),q+=D.count*D.bytePerElement})}y.setAttributesDrawBlock(x),y.addToImplementation(M()),y.addToAPI(["draw: draw,"]);function M(){let q=O.map(H=>H.getDraw()),D=[],P=[],U=[];z.forEach(H=>{D.push(H.getDraw()),P.push(H.getDivisor(0)),U.push(H.getDivisor(0))});let K=[];return z.length?(I.forEach(H=>{P.push(H.getDivisor(1)),U.push(H.getDivisor(0))}),K.push(P.join(`
    `)),K.push("gle.drawArraysInstancedANGLE(gl.TRIANGLES, 0, 6, count)"),K.push(U.join(`
    `))):K.push("gl.drawArrays(gl.TRIANGLES, 0, count)"),` 
  function draw(uniforms, from, to) {
    ${ne()}
    ${fe()}
    ${u(S)}

    gl.useProgram(program);
    ${q.join(`
    `)}
    ${D.join(`
    `)}

    gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);
    ${ue()}

    ${x.join(`
    `)}
    ${K.join(`
    `)}

    ${s(S)}
  }`;function ue(){return e.sourceBuffer?"":`  if (isDirty) {
          gl.bufferData(gl.ARRAY_BUFFER, buffer, gl.DYNAMIC_DRAW);
          isDirty = false;
        }`}function ne(){return"if (count === 0) return;"}function fe(){return Y.length===0?"":Y.map(H=>`if (!${H.ready}) return;`).join(`
    `)}}}function E(S,y){y.addToInit(["  var count = 0;"]),y.addToAPI(["setCount: (newCount) => count = newCount,","getCount: () => count,"])}function F(S,y){let{attributes:I,bytePerVertex:z,itemPerVertex:O}=S;y.addToInit([`var bytePerVertex = ${z};`,`var itemPerVertex = ${O};`,`var capacity = ${(e.capacity||1)*z};`,"var buffer = new ArrayBuffer(capacity);","","var isDirty = true;","var dirtyOffset = 0;"]),I.forEach(V=>{y.addToInit(V.getInitBlockForBuffer(!0))}),y.addToAPI(["add: add,","get: get,","update: update,","remove: remove,","getBuffer: getBuffer,","appendBuffer: appendBuffer,"]),y.addToImplementation(Q());function Q(){let V=[],W=[],Y=[],x=[],M=0;return I.forEach(q),`
  function add(item) {
    if (count * bytePerVertex >= capacity) {
      extend();
    }

    var index = count * itemPerVertex;

    ${V.join("")}

    isDirty = true;
    return count++;
  }

  function update(index, item) {
    ${B()}
    index *= itemPerVertex;
    ${V.join(`
    `)}
    isDirty = true;
  }

  function remove(index) {
    ${b()}
    isDirty = true;
    count -= 1;
    if (count <= 0) {
      count = 0;
      return count; // last element removed
    }
    // move last element to take this element's position
    var from = count * itemPerVertex;
    var to = index * itemPerVertex;
    for (var i = 0; i < itemPerVertex; ++i) {
      ${Y.join(`
`)}
    }

    return count;
  }

  function get(index) {
    index *= itemPerVertex; 
    return {
      ${W.join(`,
      `)}
    };
  }

  function extend() {
    var oldBuffer = buffer;
    capacity *= 2;
    buffer = new ArrayBuffer(capacity);
    // Copy old buffer to the new buffer
    new Uint8Array(buffer).set(new Uint8Array(oldBuffer));
    // And re-assign views:
    ${x.join(`
    `)}
  }

  function getBuffer() {
    return buffer.slice(0, count * bytePerVertex);
  }

  function appendBuffer(uint8Collection, byteOffset) {
    var requiredCapacity = byteOffset + uint8Collection.byteLength;
    if (requiredCapacity > capacity) {
      // extend the buffer to fulfill the request:
      let oldBuffer = buffer;
      buffer = new ArrayBuffer(requiredCapacity);
      new Uint8Array(buffer).set(new Uint8Array(oldBuffer));
      capacity = requiredCapacity;
    }

    var view = new Uint8Array(buffer);
    view.set(uint8Collection, byteOffset);
    count = Math.floor(requiredCapacity / bytePerVertex);

    ${x.join(`
    `)}

    isDirty = true;
  }
`;function q(D){let P=D.getInitBlockForBuffer(!1);P&&x.push(P);let U=D.getAddBlock(M,`
    `);V.push(U.code),Y.push(D.getMoveBlock(M,`
    `)),W.push(D.getGetBlock(M)),M=U.offset}}}function B(){return e.debug?`
    if (!Number.isFinite(index)) throw new Error('update() requires integer value for "index", got: ' + index);
    if (index < 0 || index >= count) throw new Error('update(' + index + ') is outside of [0..' + count + ') range');
`:""}function b(){return e.debug?`
    if (!Number.isFinite(index)) throw new Error('remove() requires integer value for "index", got: ' + index);
    if (index < 0 || index >= count) throw new Error('remove(' + index + ') is outside of [0..' + count + ') range');
`:""}function w(S,y){const I=N(t.VERTEX_SHADER,S),z=N(t.FRAGMENT_SHADER,y),O=t.createProgram();if(!O)throw new Error("Failed to link a program");if(t.attachShader(O,I),t.attachShader(O,z),t.linkProgram(O),!t.getProgramParameter(O,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(O)||"Failed to link a program");return O}function N(S,y){const I=t.createShader(S);if(!I)throw new Error("Failed to create a shared "+y);if(t.shaderSource(I,y),t.compileShader(I),!t.getShaderParameter(I,t.COMPILE_STATUS))throw console.error(t.getShaderInfoLog(I)),new Error(t.getShaderInfoLog(I)||"Failed to compile shader "+y);return I}}function rr(){return""}class Or extends uu{constructor(){super(),this.type="gl.UNSIGNED_BYTE",this.bufferViewType="Uint32Array"}getAddBlock(t){let n=`${this.name}Array`,r="";return this.debug&&(r=`if (item.${this.name} === undefined) throw new Error('Attribute "${this.name}" is missing');
`),r+=`${n}[index + ${t}] = item.${this.name};`,{code:r,offset:t+this.count}}getMoveBlock(t,n=`
`){let o=`${this.name}Array`,u="";return u+=`${o}[to + ${t}] = ${o}[from + ${t}];${n}`,u}getGetBlock(t){return`${this.name}: ${this.name}Array[index + ${t}]`}getDraw(t,n){let r=`${this.name}AttributeLocation`;return`
    if (${r} > -1) {
      gl.enableVertexAttribArray(${r});
      gl.vertexAttribPointer(${r}, 4, ${this.type}, true, ${t}, ${n});
    }`}}class nu{bufferValues;typeDef;constructor(t){this.bufferValues=t,this.typeDef=void 0}setTypeDefinition(t){this.typeDef=t}getInitBlock(){let{name:t}=this.typeDef;return`
  const ${t}InstancedBuffer = gl.createBuffer();
  if (!${t}InstancedBuffer) throw new Error('failed to create a WebGL buffer');
  const ${t}InstancedBufferValues = new Float32Array([${this.bufferValues.join(",")}]);
  let ${t}AttributeLocation = gl.getAttribLocation(program, '${t}');
`}getDivisor(t){return this.typeDef.getDivisor(t)}getDraw(){let{typeDef:t}=this,n=t.name;return`
  gl.bindBuffer(gl.ARRAY_BUFFER, ${n}InstancedBuffer);
  gl.bufferData(gl.ARRAY_BUFFER, ${n}InstancedBufferValues, gl.STATIC_DRAW);

  gl.enableVertexAttribArray(${n}AttributeLocation);
  gl.vertexAttribPointer(${n}AttributeLocation, ${t.count}, gl.FLOAT, false, 0, 0);
`}}class iu extends Nr{uniforms;program;constructor(t){super(),this.program=t,this.uniforms=void 0}getBuffer(){return this.program.getBuffer()}appendBuffer(t,n){this.program.appendBuffer(t,n),this.scene&&this.scene.renderFrame()}add(t){return this.program.add(t)}update(t,n){this.program.update(t,n)}remove(t){return this.program.remove(t)}get(t){return this.program.get(t)}draw(t,n){this.uniforms||(this.uniforms={projectionMatrix:n.projection,model:this.worldModel,view:n.view.matrix,modelViewProjection:this.modelViewProjection}),this.program.draw(this.uniforms)}dispose(){super.dispose(),this.program&&this.program.dispose()}}function it(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ft={exports:{}},He={exports:{}},Ot,nr;function zr(){return nr||(nr=1,Ot=function(t){return t===0?"x":t===1?"y":t===2?"z":"c"+(t+1)}),Ot}var zt,ir;function Xe(){if(ir)return zt;ir=1;const e=zr();return zt=function(n){return r;function r(o,u){let s=u&&u.indent||0,l=u&&u.join!==void 0?u.join:`
`,c=Array(s+1).join(" "),h=[];for(let f=0;f<n;++f){let A=e(f),g=f===0?"":c;h.push(g+o.replace(/{var}/g,A))}return h.join(l)}},zt}var or;function ta(){if(or)return He.exports;or=1;const e=Xe();He.exports=t,He.exports.generateCreateBodyFunctionBody=n,He.exports.getVectorCode=o,He.exports.getBodyCode=r;function t(u,s){let l=n(u,s),{Body:c}=new Function(l)();return c}function n(u,s){return`
${o(u,s)}
${r(u)}
return {Body: Body, Vector: Vector};
`}function r(u){let s=e(u),l=s("{var}",{join:", "});return`
function Body(${l}) {
  this.isPinned = false;
  this.pos = new Vector(${l});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${l}) {
  ${s("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function o(u,s){let l=e(u),c="";return s&&(c=`${l(`
	   var v{var};
	Object.defineProperty(this, '{var}', {
	  set: function(v) { 
	    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
	    v{var} = v; 
	  },
	  get: function() { return v{var}; }
	});`)}`),`function Vector(${l("{var}",{join:", "})}) {
  ${c}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${l('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${l("this.{var} = v.{var};",{indent:4})}
    } else {
      ${l('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${l("this.{var} = ",{join:""})}0;
  };`}return He.exports}var Pe={exports:{}},ar;function ua(){if(ar)return Pe.exports;ar=1;const e=Xe(),t=zr();Pe.exports=n,Pe.exports.generateQuadTreeFunctionBody=r,Pe.exports.getInsertStackCode=c,Pe.exports.getQuadNodeCode=l,Pe.exports.isSamePosition=o,Pe.exports.getChildBodyCode=s,Pe.exports.setChildBodyCode=u;function n(h){let f=r(h);return new Function(f)()}function r(h){let f=e(h),A=Math.pow(2,h);return`
${c()}
${l(h)}
${o(h)}
${s(h)}
${u(h)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${E("      node.")}
      node.body = null;
      node.mass = ${f("node.mass_{var} = ",{join:""})}0;
      ${f("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${f("var d{var};",{indent:4})}
    var r; 
    ${f("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${f("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${f("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${f("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${f("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${f("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${f("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${f("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${f("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${f("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < , treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${t(0)} - node.min_${t(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${f("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${v()}
        }
      }
    }

    ${f("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${f("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${f("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${f("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${f("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${f("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${f("root.min_{var} = {var}min;",{indent:4})}
    ${f("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${f("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${f("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${f("var min_{var} = node.min_{var};",{indent:8})}
        ${f("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${m(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${f("child.min_{var} = min_{var};",{indent:10})}
          ${f("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${f("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${f("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function m(F){let B=[],b=Array(F+1).join(" ");for(let w=0;w<h;++w)B.push(b+`if (${t(w)} > max_${t(w)}) {`),B.push(b+`  quadIdx = quadIdx + ${Math.pow(2,w)};`),B.push(b+`  min_${t(w)} = max_${t(w)};`),B.push(b+`  max_${t(w)} = node.max_${t(w)};`),B.push(b+"}");return B.join(`
`)}function v(){let F=Array(11).join(" "),B=[];for(let b=0;b<A;++b)B.push(F+`if (node.quad${b}) {`),B.push(F+`  queue[pushIdx] = node.quad${b};`),B.push(F+"  queueLength += 1;"),B.push(F+"  pushIdx += 1;"),B.push(F+"}");return B.join(`
`)}function E(F){let B=[];for(let b=0;b<A;++b)B.push(`${F}quad${b} = null;`);return B.join(`
`)}}function o(h){let f=e(h);return`
  function isSamePosition(point1, point2) {
    ${f("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${f("d{var} < 1e-8",{join:" && "})};
  }  
`}function u(h){var f=Math.pow(2,h);return`
function setChild(node, idx, child) {
  ${A()}
}`;function A(){let g=[];for(let m=0;m<f;++m){let v=m===0?"  ":"  else ";g.push(`${v}if (idx === ${m}) node.quad${m} = child;`)}return g.join(`
`)}}function s(h){return`function getChild(node, idx) {
${f()}
  return null;
}`;function f(){let A=[],g=Math.pow(2,h);for(let m=0;m<g;++m)A.push(`  if (idx === ${m}) return node.quad${m};`);return A.join(`
`)}}function l(h){let f=e(h),A=Math.pow(2,h);var g=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${m("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${f("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${f("this.min_{var} = 0;",{indent:2})}
  ${f("this.max_{var} = 0;",{indent:2})}
}
`;return g;function m(v){let E=[];for(let F=0;F<A;++F)E.push(`${v}quad${F} = null;`);return E.join(`
`)}}function c(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}return Pe.exports}var dt={exports:{}},sr;function ra(){if(sr)return dt.exports;sr=1,dt.exports=t,dt.exports.generateFunctionBody=n;const e=Xe();function t(r){let o=n(r);return new Function("bodies","settings","random",o)}function n(r){let o=e(r);return`
  var boundingBox = {
    ${o("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${o("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${o("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${o("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${o("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${o("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${o("var max_{var} = -Infinity;",{indent:4})}
    ${o("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${o("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${o("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${o("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${o("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${o("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}return dt.exports}var ht={exports:{}},cr;function na(){if(cr)return ht.exports;cr=1;const e=Xe();ht.exports=t,ht.exports.generateCreateDragForceFunctionBody=n;function t(r){let o=n(r);return new Function("options",o)}function n(r){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${e(r)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}return ht.exports}var gt={exports:{}},lr;function ia(){if(lr)return gt.exports;lr=1;const e=Xe();gt.exports=t,gt.exports.generateCreateSpringForceFunctionBody=n;function t(r){let o=n(r);return new Function("options","random",o)}function n(r){let o=e(r);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${o("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${o("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${o("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${o("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${o("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${o("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}return gt.exports}var At={exports:{}},fr;function oa(){if(fr)return At.exports;fr=1;const e=Xe();At.exports=t,At.exports.generateIntegratorFunctionBody=n;function t(r){let o=n(r);return new Function("bodies","timeStep","adaptiveTimeStepWeight",o)}function n(r){let o=e(r);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${o("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${o("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${o("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${o("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${o("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${o("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${o("body.pos.{var} += d{var};",{indent:4})}

    ${o("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${o("t{var} * t{var}",{join:" + "})})/length;
`}return At.exports}var Vt,dr;function aa(){if(dr)return Vt;dr=1,Vt=e;function e(t,n,r,o){this.from=t,this.to=n,this.length=r,this.coefficient=o}return Vt}var jt,hr;function sa(){if(hr)return jt;hr=1,jt=e;function e(t,n){var r;if(t||(t={}),n){for(r in n)if(n.hasOwnProperty(r)){var o=t.hasOwnProperty(r),u=typeof n[r],s=!o||typeof t[r]!==u;s?t[r]=n[r]:u==="object"&&(t[r]=e(t[r],n[r]))}}return t}return jt}var Ut,gr;function ou(){if(gr)return Ut;gr=1,Ut=function(r){t(r);var o=e(r);return r.on=o.on,r.off=o.off,r.fire=o.fire,r};function e(n){var r=Object.create(null);return{on:function(o,u,s){if(typeof u!="function")throw new Error("callback is expected to be a function");var l=r[o];return l||(l=r[o]=[]),l.push({callback:u,ctx:s}),n},off:function(o,u){var s=typeof o>"u";if(s)return r=Object.create(null),n;if(r[o]){var l=typeof u!="function";if(l)delete r[o];else for(var c=r[o],h=0;h<c.length;++h)c[h].callback===u&&c.splice(h,1)}return n},fire:function(o){var u=r[o];if(!u)return n;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var l=0;l<u.length;++l){var c=u[l];c.callback.apply(c.ctx,s)}return n}}}function t(n){if(!n)throw new Error("Eventify cannot use falsy object as events subject");for(var r=["on","fire","off"],o=0;o<r.length;++o)if(n.hasOwnProperty(r[o]))throw new Error("Subject cannot be eventified, since it already has property '"+r[o]+"'")}return Ut}var et={exports:{}},Ar;function Vr(){if(Ar)return et.exports;Ar=1,et.exports=e,et.exports.random=e,et.exports.randomIterator=l;function e(c){var h=typeof c=="number"?c:+new Date;return new t(h)}function t(c){this.seed=c}t.prototype.next=s,t.prototype.nextDouble=u,t.prototype.uniform=u,t.prototype.gaussian=n,t.prototype.random=u;function n(){var c,h,f;do h=this.nextDouble()*2-1,f=this.nextDouble()*2-1,c=h*h+f*f;while(c>=1||c===0);return h*Math.sqrt(-2*Math.log(c)/c)}t.prototype.levy=r;function r(){var c=1.5,h=Math.pow(o(1+c)*Math.sin(Math.PI*c/2)/(o((1+c)/2)*c*Math.pow(2,(c-1)/2)),1/c);return this.gaussian()*h/Math.pow(Math.abs(this.gaussian()),1/c)}function o(c){return Math.sqrt(2*Math.PI/c)*Math.pow(1/Math.E*(c+1/(12*c-1/(10*c))),c)}function u(){var c=this.seed;return c=c+2127912214+(c<<12)&4294967295,c=(c^3345072700^c>>>19)&4294967295,c=c+374761393+(c<<5)&4294967295,c=(c+3550635116^c<<9)&4294967295,c=c+4251993797+(c<<3)&4294967295,c=(c^3042594569^c>>>16)&4294967295,this.seed=c,(c&268435455)/268435456}function s(c){return Math.floor(this.nextDouble()*c)}function l(c,h){var f=h||e();if(typeof f.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:g,shuffle:A};function A(){var m,v,E;for(m=c.length-1;m>0;--m)v=f.next(m+1),E=c[v],c[v]=c[m],c[m]=E;return c}function g(m){var v,E,F;for(v=c.length-1;v>0;--v)E=f.next(v+1),F=c[E],c[E]=c[v],c[v]=F,m(F);c.length&&m(c[0])}}return et.exports}var Wt,mr;function vr(){if(mr)return Wt;mr=1,Wt=l;var e=ta(),t=ua(),n=ra(),r=na(),o=ia(),u=oa(),s={};function l(f){var A=aa(),g=sa(),m=ou();if(f){if(f.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(f.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}f=g(f,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var v=s[f.dimensions];if(!v){var E=f.dimensions;v={Body:e(E,f.debug),createQuadTree:t(E),createBounds:n(E),createDragForce:r(E),createSpringForce:o(E),integrate:u(E)},s[E]=v}var F=v.Body,B=v.createQuadTree,b=v.createBounds,w=v.createDragForce,N=v.createSpringForce,S=v.integrate,y=j=>new F(j),I=Vr().random(42),z=[],O=[],Q=B(f,I),V=b(z,f,I),W=N(f,I),Y=w(f),x=0,M=[],q=new Map,D=0;K("nbody",fe),K("spring",H);var P={bodies:z,quadTree:Q,springs:O,settings:f,addForce:K,removeForce:ue,getForces:ne,step:function(){for(var j=0;j<M.length;++j)M[j](D);var L=S(z,f.timeStep,f.adaptiveTimeStepWeight);return D+=1,L},addBody:function(j){if(!j)throw new Error("Body is required");return z.push(j),j},addBodyAt:function(j){if(!j)throw new Error("Body position is required");var L=y(j);return z.push(L),L},removeBody:function(j){if(j){var L=z.indexOf(j);if(!(L<0))return z.splice(L,1),z.length===0&&V.reset(),!0}},addSpring:function(j,L,k,G){if(!j||!L)throw new Error("Cannot add null spring to force simulator");typeof k!="number"&&(k=-1);var Z=new A(j,L,k,G>=0?G:-1);return O.push(Z),Z},getTotalMovement:function(){return x},removeSpring:function(j){if(j){var L=O.indexOf(j);if(L>-1)return O.splice(L,1),!0}},getBestNewBodyPosition:function(j){return V.getBestNewPosition(j)},getBBox:U,getBoundingBox:U,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(j){return j!==void 0?(f.gravity=j,Q.options({gravity:j}),this):f.gravity},theta:function(j){return j!==void 0?(f.theta=j,Q.options({theta:j}),this):f.theta},random:I};return c(f,P),m(P),P;function U(){return V.update(),V.box}function K(j,L){if(q.has(j))throw new Error("Force "+j+" is already added");q.set(j,L),M.push(L)}function ue(j){var L=M.indexOf(q.get(j));L<0||(M.splice(L,1),q.delete(j))}function ne(){return q}function fe(){if(z.length!==0){Q.insertBodies(z);for(var j=z.length;j--;){var L=z[j];L.isPinned||(L.reset(),Q.updateBodyForce(L),Y.update(L))}}}function H(){for(var j=O.length;j--;)W.update(O[j])}}function c(f,A){for(var g in f)h(f,A,g)}function h(f,A,g){if(f.hasOwnProperty(g)&&typeof A[g]!="function"){var m=Number.isFinite(f[g]);m?A[g]=function(v){if(v!==void 0){if(!Number.isFinite(v))throw new Error("Value of "+g+" should be a valid number.");return f[g]=v,A}return f[g]}:A[g]=function(v){return v!==void 0?(f[g]=v,A):f[g]}}}return Wt}var Er;function ca(){if(Er)return ft.exports;Er=1,ft.exports=t,ft.exports.simulator=vr();var e=ou();function t(r,o){if(!r)throw new Error("Graph structure cannot be undefined");var u=o&&o.createSimulator||vr(),s=u(o);if(Array.isArray(o))throw new Error("Physics settings is expected to be an object");var l=r.version>19?q:M;o&&typeof o.nodeMass=="function"&&(l=o.nodeMass);var c=new Map,h={},f=0,A=s.settings.springTransform||n;y(),w();var g=!1,m={step:function(){if(f===0)return v(!0),!0;var D=s.step();m.lastMove=D,m.fire("step");var P=D/f,U=P<=.01;return v(U),U},getNodePosition:function(D){return x(D).pos},setNodePosition:function(D){var P=x(D);P.setPosition.apply(P,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(D){var P=h[D];if(P)return{from:P.from.pos,to:P.to.pos}},getGraphRect:function(){return s.getBBox()},forEachBody:E,pinNode:function(D,P){var U=x(D.id);U.isPinned=!!P},isNodePinned:function(D){return x(D.id).isPinned},dispose:function(){r.off("changed",S),m.fire("disposed")},getBody:b,getSpring:B,getForceVectorLength:F,simulator:s,graph:r,lastMove:0};return e(m),m;function v(D){g!==D&&(g=D,N(D))}function E(D){c.forEach(D)}function F(){var D=0,P=0;return E(function(U){D+=Math.abs(U.force.x),P+=Math.abs(U.force.y)}),Math.sqrt(D*D+P*P)}function B(D,P){var U;if(P===void 0)typeof D!="object"?U=D:U=D.id;else{var K=r.hasLink(D,P);if(!K)return;U=K.id}return h[U]}function b(D){return c.get(D)}function w(){r.on("changed",S)}function N(D){m.fire("stable",D)}function S(D){for(var P=0;P<D.length;++P){var U=D[P];U.changeType==="add"?(U.node&&I(U.node.id),U.link&&O(U.link)):U.changeType==="remove"&&(U.node&&z(U.node),U.link&&Q(U.link))}f=r.getNodesCount()}function y(){f=0,r.forEachNode(function(D){I(D.id),f+=1}),r.forEachLink(O)}function I(D){var P=c.get(D);if(!P){var U=r.getNode(D);if(!U)throw new Error("initBody() was called with unknown node id");var K=U.position;if(!K){var ue=V(U);K=s.getBestNewBodyPosition(ue)}P=s.addBodyAt(K),P.id=D,c.set(D,P),W(D),Y(U)&&(P.isPinned=!0)}}function z(D){var P=D.id,U=c.get(P);U&&(c.delete(P),s.removeBody(U))}function O(D){W(D.fromId),W(D.toId);var P=c.get(D.fromId),U=c.get(D.toId),K=s.addSpring(P,U,D.length);A(D,K),h[D.id]=K}function Q(D){var P=h[D.id];if(P){var U=r.getNode(D.fromId),K=r.getNode(D.toId);U&&W(U.id),K&&W(K.id),delete h[D.id],s.removeSpring(P)}}function V(D){var P=[];if(!D.links)return P;for(var U=Math.min(D.links.length,2),K=0;K<U;++K){var ue=D.links[K],ne=ue.fromId!==D.id?c.get(ue.fromId):c.get(ue.toId);ne&&ne.pos&&P.push(ne)}return P}function W(D){var P=c.get(D);if(P.mass=l(D),Number.isNaN(P.mass))throw new Error("Node mass should be a number")}function Y(D){return D&&(D.isPinned||D.data&&D.data.isPinned)}function x(D){var P=c.get(D);return P||(I(D),P=c.get(D)),P}function M(D){var P=r.getLinks(D);return P?1+P.length/3:1}function q(D){var P=r.getLinks(D);return P?1+P.size/3:1}}function n(){}return ft.exports}var la=ca();const fa=it(la);var mt={exports:{}},Gt,pr;function da(){return pr||(pr=1,Gt={nodes:[{name:"Myriel",group:1},{name:"Napoleon",group:1},{name:"Mlle.Baptistine",group:1},{name:"Mme.Magloire",group:1},{name:"CountessdeLo",group:1},{name:"Geborand",group:1},{name:"Champtercier",group:1},{name:"Cravatte",group:1},{name:"Count",group:1},{name:"OldMan",group:1},{name:"Labarre",group:2},{name:"Valjean",group:2},{name:"Marguerite",group:3},{name:"Mme.deR",group:2},{name:"Isabeau",group:2},{name:"Gervais",group:2},{name:"Tholomyes",group:3},{name:"Listolier",group:3},{name:"Fameuil",group:3},{name:"Blacheville",group:3},{name:"Favourite",group:3},{name:"Dahlia",group:3},{name:"Zephine",group:3},{name:"Fantine",group:3},{name:"Mme.Thenardier",group:4},{name:"Thenardier",group:4},{name:"Cosette",group:5},{name:"Javert",group:4},{name:"Fauchelevent",group:0},{name:"Bamatabois",group:2},{name:"Perpetue",group:3},{name:"Simplice",group:2},{name:"Scaufflaire",group:2},{name:"Woman1",group:2},{name:"Judge",group:2},{name:"Champmathieu",group:2},{name:"Brevet",group:2},{name:"Chenildieu",group:2},{name:"Cochepaille",group:2},{name:"Pontmercy",group:4},{name:"Boulatruelle",group:6},{name:"Eponine",group:4},{name:"Anzelma",group:4},{name:"Woman2",group:5},{name:"MotherInnocent",group:0},{name:"Gribier",group:0},{name:"Jondrette",group:7},{name:"Mme.Burgon",group:7},{name:"Gavroche",group:8},{name:"Gillenormand",group:5},{name:"Magnon",group:5},{name:"Mlle.Gillenormand",group:5},{name:"Mme.Pontmercy",group:5},{name:"Mlle.Vaubois",group:5},{name:"Lt.Gillenormand",group:5},{name:"Marius",group:8},{name:"BaronessT",group:5},{name:"Mabeuf",group:8},{name:"Enjolras",group:8},{name:"Combeferre",group:8},{name:"Prouvaire",group:8},{name:"Feuilly",group:8},{name:"Courfeyrac",group:8},{name:"Bahorel",group:8},{name:"Bossuet",group:8},{name:"Joly",group:8},{name:"Grantaire",group:8},{name:"MotherPlutarch",group:9},{name:"Gueulemer",group:4},{name:"Babet",group:4},{name:"Claquesous",group:4},{name:"Montparnasse",group:4},{name:"Toussaint",group:5},{name:"Child1",group:10},{name:"Child2",group:10},{name:"Brujon",group:4},{name:"Mme.Hucheloup",group:8}],links:[{source:1,target:0,value:1},{source:2,target:0,value:8},{source:3,target:0,value:10},{source:3,target:2,value:6},{source:4,target:0,value:1},{source:5,target:0,value:1},{source:6,target:0,value:1},{source:7,target:0,value:1},{source:8,target:0,value:2},{source:9,target:0,value:1},{source:11,target:10,value:1},{source:11,target:3,value:3},{source:11,target:2,value:3},{source:11,target:0,value:5},{source:12,target:11,value:1},{source:13,target:11,value:1},{source:14,target:11,value:1},{source:15,target:11,value:1},{source:17,target:16,value:4},{source:18,target:16,value:4},{source:18,target:17,value:4},{source:19,target:16,value:4},{source:19,target:17,value:4},{source:19,target:18,value:4},{source:20,target:16,value:3},{source:20,target:17,value:3},{source:20,target:18,value:3},{source:20,target:19,value:4},{source:21,target:16,value:3},{source:21,target:17,value:3},{source:21,target:18,value:3},{source:21,target:19,value:3},{source:21,target:20,value:5},{source:22,target:16,value:3},{source:22,target:17,value:3},{source:22,target:18,value:3},{source:22,target:19,value:3},{source:22,target:20,value:4},{source:22,target:21,value:4},{source:23,target:16,value:3},{source:23,target:17,value:3},{source:23,target:18,value:3},{source:23,target:19,value:3},{source:23,target:20,value:4},{source:23,target:21,value:4},{source:23,target:22,value:4},{source:23,target:12,value:2},{source:23,target:11,value:9},{source:24,target:23,value:2},{source:24,target:11,value:7},{source:25,target:24,value:13},{source:25,target:23,value:1},{source:25,target:11,value:12},{source:26,target:24,value:4},{source:26,target:11,value:31},{source:26,target:16,value:1},{source:26,target:25,value:1},{source:27,target:11,value:17},{source:27,target:23,value:5},{source:27,target:25,value:5},{source:27,target:24,value:1},{source:27,target:26,value:1},{source:28,target:11,value:8},{source:28,target:27,value:1},{source:29,target:23,value:1},{source:29,target:27,value:1},{source:29,target:11,value:2},{source:30,target:23,value:1},{source:31,target:30,value:2},{source:31,target:11,value:3},{source:31,target:23,value:2},{source:31,target:27,value:1},{source:32,target:11,value:1},{source:33,target:11,value:2},{source:33,target:27,value:1},{source:34,target:11,value:3},{source:34,target:29,value:2},{source:35,target:11,value:3},{source:35,target:34,value:3},{source:35,target:29,value:2},{source:36,target:34,value:2},{source:36,target:35,value:2},{source:36,target:11,value:2},{source:36,target:29,value:1},{source:37,target:34,value:2},{source:37,target:35,value:2},{source:37,target:36,value:2},{source:37,target:11,value:2},{source:37,target:29,value:1},{source:38,target:34,value:2},{source:38,target:35,value:2},{source:38,target:36,value:2},{source:38,target:37,value:2},{source:38,target:11,value:2},{source:38,target:29,value:1},{source:39,target:25,value:1},{source:40,target:25,value:1},{source:41,target:24,value:2},{source:41,target:25,value:3},{source:42,target:41,value:2},{source:42,target:25,value:2},{source:42,target:24,value:1},{source:43,target:11,value:3},{source:43,target:26,value:1},{source:43,target:27,value:1},{source:44,target:28,value:3},{source:44,target:11,value:1},{source:45,target:28,value:2},{source:47,target:46,value:1},{source:48,target:47,value:2},{source:48,target:25,value:1},{source:48,target:27,value:1},{source:48,target:11,value:1},{source:49,target:26,value:3},{source:49,target:11,value:2},{source:50,target:49,value:1},{source:50,target:24,value:1},{source:51,target:49,value:9},{source:51,target:26,value:2},{source:51,target:11,value:2},{source:52,target:51,value:1},{source:52,target:39,value:1},{source:53,target:51,value:1},{source:54,target:51,value:2},{source:54,target:49,value:1},{source:54,target:26,value:1},{source:55,target:51,value:6},{source:55,target:49,value:12},{source:55,target:39,value:1},{source:55,target:54,value:1},{source:55,target:26,value:21},{source:55,target:11,value:19},{source:55,target:16,value:1},{source:55,target:25,value:2},{source:55,target:41,value:5},{source:55,target:48,value:4},{source:56,target:49,value:1},{source:56,target:55,value:1},{source:57,target:55,value:1},{source:57,target:41,value:1},{source:57,target:48,value:1},{source:58,target:55,value:7},{source:58,target:48,value:7},{source:58,target:27,value:6},{source:58,target:57,value:1},{source:58,target:11,value:4},{source:59,target:58,value:15},{source:59,target:55,value:5},{source:59,target:48,value:6},{source:59,target:57,value:2},{source:60,target:48,value:1},{source:60,target:58,value:4},{source:60,target:59,value:2},{source:61,target:48,value:2},{source:61,target:58,value:6},{source:61,target:60,value:2},{source:61,target:59,value:5},{source:61,target:57,value:1},{source:61,target:55,value:1},{source:62,target:55,value:9},{source:62,target:58,value:17},{source:62,target:59,value:13},{source:62,target:48,value:7},{source:62,target:57,value:2},{source:62,target:41,value:1},{source:62,target:61,value:6},{source:62,target:60,value:3},{source:63,target:59,value:5},{source:63,target:48,value:5},{source:63,target:62,value:6},{source:63,target:57,value:2},{source:63,target:58,value:4},{source:63,target:61,value:3},{source:63,target:60,value:2},{source:63,target:55,value:1},{source:64,target:55,value:5},{source:64,target:62,value:12},{source:64,target:48,value:5},{source:64,target:63,value:4},{source:64,target:58,value:10},{source:64,target:61,value:6},{source:64,target:60,value:2},{source:64,target:59,value:9},{source:64,target:57,value:1},{source:64,target:11,value:1},{source:65,target:63,value:5},{source:65,target:64,value:7},{source:65,target:48,value:3},{source:65,target:62,value:5},{source:65,target:58,value:5},{source:65,target:61,value:5},{source:65,target:60,value:2},{source:65,target:59,value:5},{source:65,target:57,value:1},{source:65,target:55,value:2},{source:66,target:64,value:3},{source:66,target:58,value:3},{source:66,target:59,value:1},{source:66,target:62,value:2},{source:66,target:65,value:2},{source:66,target:48,value:1},{source:66,target:63,value:1},{source:66,target:61,value:1},{source:66,target:60,value:1},{source:67,target:57,value:3},{source:68,target:25,value:5},{source:68,target:11,value:1},{source:68,target:24,value:1},{source:68,target:27,value:1},{source:68,target:48,value:1},{source:68,target:41,value:1},{source:69,target:25,value:6},{source:69,target:68,value:6},{source:69,target:11,value:1},{source:69,target:24,value:1},{source:69,target:27,value:2},{source:69,target:48,value:1},{source:69,target:41,value:1},{source:70,target:25,value:4},{source:70,target:69,value:4},{source:70,target:68,value:4},{source:70,target:11,value:1},{source:70,target:24,value:1},{source:70,target:27,value:1},{source:70,target:41,value:1},{source:70,target:58,value:1},{source:71,target:27,value:1},{source:71,target:69,value:2},{source:71,target:68,value:2},{source:71,target:70,value:2},{source:71,target:11,value:1},{source:71,target:48,value:1},{source:71,target:41,value:1},{source:71,target:25,value:1},{source:72,target:26,value:2},{source:72,target:27,value:1},{source:72,target:11,value:1},{source:73,target:48,value:2},{source:74,target:48,value:2},{source:74,target:73,value:3},{source:75,target:69,value:3},{source:75,target:68,value:3},{source:75,target:25,value:3},{source:75,target:48,value:1},{source:75,target:41,value:1},{source:75,target:70,value:1},{source:75,target:71,value:1},{source:76,target:64,value:1},{source:76,target:65,value:1},{source:76,target:66,value:1},{source:76,target:63,value:1},{source:76,target:62,value:1},{source:76,target:48,value:1},{source:76,target:58,value:1}]}),Gt}var Yt,Cr;function au(){if(Cr)return Yt;Cr=1,Yt=t;var e=ou();function t(s){if(s=s||{},"uniqueLinkId"in s&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),s.multigraph=s.uniqueLinkId),s.multigraph===void 0&&(s.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var l=new Map,c=new Map,h={},f=0,A=s.multigraph?Q:O,g=[],m=ne,v=ne,E=ne,F=ne,B={version:20,addNode:S,addLink:z,removeLink:x,removeNode:I,getNode:y,getNodeCount:V,getLinkCount:W,getEdgeCount:W,getLinksCount:W,getNodesCount:V,getLinks:Y,forEachNode:j,forEachLinkedNode:U,forEachLink:P,beginUpdate:E,endUpdate:F,clear:D,hasLink:q,hasNode:y,getLink:q};return e(B),b(),B;function b(){var L=B.on;B.on=k;function k(){return B.beginUpdate=E=fe,B.endUpdate=F=H,m=w,v=N,B.on=L,L.apply(B,arguments)}}function w(L,k){g.push({link:L,changeType:k})}function N(L,k){g.push({node:L,changeType:k})}function S(L,k){if(L===void 0)throw new Error("Invalid node identifier");E();var G=y(L);return G?(G.data=k,v(G,"update")):(G=new n(L,k),v(G,"add")),l.set(L,G),F(),G}function y(L){return l.get(L)}function I(L){var k=y(L);if(!k)return!1;E();var G=k.links;return G&&(G.forEach(M),k.links=null),l.delete(L),v(k,"remove"),F(),!0}function z(L,k,G){E();var Z=y(L)||S(L),re=y(k)||S(k),ie=A(L,k,G),le=c.has(ie.id);return c.set(ie.id,ie),r(Z,ie),L!==k&&r(re,ie),m(ie,le?"update":"add"),F(),ie}function O(L,k,G){var Z=u(L,k),re=c.get(Z);return re?(re.data=G,re):new o(L,k,G,Z)}function Q(L,k,G){var Z=u(L,k),re=h.hasOwnProperty(Z);if(re||q(L,k)){re||(h[Z]=0);var ie="@"+ ++h[Z];Z=u(L+ie,k+ie)}return new o(L,k,G,Z)}function V(){return l.size}function W(){return c.size}function Y(L){var k=y(L);return k?k.links:null}function x(L,k){return k!==void 0&&(L=q(L,k)),M(L)}function M(L){if(!L||!c.get(L.id))return!1;E(),c.delete(L.id);var k=y(L.fromId),G=y(L.toId);return k&&k.links.delete(L),G&&G.links.delete(L),m(L,"remove"),F(),!0}function q(L,k){if(!(L===void 0||k===void 0))return c.get(u(L,k))}function D(){E(),j(function(L){I(L.id)}),F()}function P(L){if(typeof L=="function")for(var k=c.values(),G=k.next();!G.done;){if(L(G.value))return!0;G=k.next()}}function U(L,k,G){var Z=y(L);if(Z&&Z.links&&typeof k=="function")return G?ue(Z.links,L,k):K(Z.links,L,k)}function K(L,k,G){for(var Z,re=L.values(),ie=re.next();!ie.done;){var le=ie.value,we=le.fromId===k?le.toId:le.fromId;if(Z=G(l.get(we),le),Z)return!0;ie=re.next()}}function ue(L,k,G){for(var Z,re=L.values(),ie=re.next();!ie.done;){var le=ie.value;if(le.fromId===k&&(Z=G(l.get(le.toId),le),Z))return!0;ie=re.next()}}function ne(){}function fe(){f+=1}function H(){f-=1,f===0&&g.length>0&&(B.fire("changed",g),g.length=0)}function j(L){if(typeof L!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+L);for(var k=l.values(),G=k.next();!G.done;){if(L(G.value))return!0;G=k.next()}}}function n(s,l){this.id=s,this.links=null,this.data=l}function r(s,l){s.links?s.links.add(l):s.links=new Set([l])}function o(s,l,c,h){this.fromId=s,this.toId=l,this.data=c,this.id=h}function u(s,l){return s.toString()+" "+l.toString()}return Yt}var Fr;function ha(){if(Fr)return mt.exports;Fr=1;var e=da(),t=au();mt.exports=n(),mt.exports.create=n;function n(){for(var r=t(),o=0;o<e.nodes.length;++o)r.addNode(o,e.nodes[o]);for(o=0;o<e.links.length;++o){var u=e.links[o];r.addLink(u.source,u.target,u.value)}return r}return mt.exports}var ga=ha();const Aa=it(ga);function yr(e,t={}){const n=t.linkWeight||(B=>B.data&&typeof B.data.weight=="number"?B.data.weight:1),r=t.nodeSize||(B=>B.data&&typeof B.data.size=="number"?B.data.size:1),o=!!t.directed,u=t.baseNodeIds,s=[],l=new Map;if(Array.isArray(u)&&u.length>0)for(let B=0;B<u.length;B++){const b=u[B];if(!(e.getNode?e.getNode(b):null))throw new Error("Multilayer graphs must share identical node ids. Missing: "+b);l.set(b,B),s.push(b)}else e.forEachNode(B=>{l.set(B.id,s.length),s.push(B.id)});const c=s.length,h=new Float64Array(c),f=new Float64Array(c),A=new Float64Array(c),g=new Float64Array(c),m=new Array(c),v=new Array(c);for(let B=0;B<c;B++)m[B]=[],v[B]=[];if(o)e.forEachLink(B=>{const b=l.get(B.fromId),w=l.get(B.toId);if(b==null||w==null)return;const N=+n(B)||0;b===w&&(f[b]+=N),m[b].push({to:w,w:N}),v[w].push({from:b,w:N}),A[b]+=N,g[w]+=N});else{const B=new Map;e.forEachLink(b=>{const w=l.get(b.fromId),N=l.get(b.toId);if(w==null||N==null)return;const S=+n(b)||0;if(w===N){f[w]+=S;return}const y=w<N?w:N,I=w<N?N:w,z=y+":"+I;let O=B.get(z);O||(O={sum:0,seenAB:0,seenBA:0},B.set(z,O)),O.sum+=S,w===y?O.seenAB=1:O.seenBA=1});for(const[b,w]of B.entries()){const[N,S]=b.split(":"),y=+N,I=+S,z=(w.seenAB?1:0)+(w.seenBA?1:0),O=z>0?w.sum/z:0;O!==0&&(m[y].push({to:I,w:O}),m[I].push({to:y,w:O}),v[y].push({from:I,w:O}),v[I].push({from:y,w:O}),A[y]+=O,A[I]+=O,g[y]+=O,g[I]+=O)}for(let b=0;b<c;b++){const w=f[b];w!==0&&(m[b].push({to:b,w}),v[b].push({from:b,w}),A[b]+=w,g[b]+=w)}}e.forEachNode(B=>{const b=l.get(B.id);h[b]=+r(B)||0});const E=A.reduce((B,b)=>B+b,0);function F(B,b){const w=m[B];for(let N=0;N<w.length;N++)b(w[N].to,w[N].w)}return{n:c,nodeIds:s,idToIndex:l,size:h,selfLoop:f,strengthOut:A,strengthIn:g,outEdges:m,inEdges:v,directed:o,totalWeight:E,forEachNeighbor:F}}function jr(e){const t=e.n,n=new Int32Array(t);for(let x=0;x<t;x++)n[x]=x;let r=t,o=new Float64Array(r),u=new Int32Array(r),s=new Float64Array(r),l=new Float64Array(r),c=new Float64Array(r),h=new Float64Array(r),f=new Int32Array(t),A=0,g=new Float64Array(t),m=new Float64Array(t),v=new Float64Array(t),E=new Uint8Array(t);function F(x){if(x<=o.length)return;const M=Math.max(x,Math.ceil(o.length*1.5));o=tt(o,M),u=ma(u,M),s=tt(s,M),l=tt(l,M),c=tt(c,M),h=tt(h,M)}function B(){o.fill(0),u.fill(0),s.fill(0),l.fill(0),c.fill(0),h.fill(0);for(let x=0;x<t;x++){const M=n[x];o[M]+=e.size[x],u[M]+=1,e.directed?(c[M]+=e.strengthOut[x],h[M]+=e.strengthIn[x]):l[M]+=e.strengthOut[x],e.selfLoop[x]!==0&&(s[M]+=e.selfLoop[x])}if(e.directed)for(let x=0;x<t;x++){const M=n[x],q=e.outEdges[x];for(let D=0;D<q.length;D++){const{to:P,w:U}=q[D];M===n[P]&&(s[M]+=U)}}else for(let x=0;x<t;x++){const M=n[x],q=e.outEdges[x];for(let D=0;D<q.length;D++){const{to:P,w:U}=q[D];P<=x||M===n[P]&&(s[M]+=U)}}}function b(){for(let x=0;x<A;x++){const M=f[x];E[M]=0,g[M]=0,m[M]=0,v[M]=0}A=0}function w(x){E[x]||(E[x]=1,f[A++]=x)}function N(x){b();const M=n[x];if(w(M),e.directed){const q=e.outEdges[x];for(let P=0;P<q.length;P++){const U=q[P].to,K=q[P].w,ue=n[U];w(ue),m[ue]+=K}const D=e.inEdges[x];for(let P=0;P<D.length;P++){const U=D[P].from,K=D[P].w,ue=n[U];w(ue),v[ue]+=K}}else{const q=e.outEdges[x];for(let D=0;D<q.length;D++){const P=q[D].to,U=q[D].w,K=n[P];w(K),g[K]+=U}}return A}const S=e.totalWeight;function y(x,M){const q=n[x];if(M===q)return 0;const D=e.strengthOut[x],P=M<g.length&&g[M]||0,U=g[q]||0,K=M<l.length?l[M]:0,ue=l[q],ne=-(U/S-D*ue/(S*S)),fe=P/S-D*K/(S*S);return ne+fe}function I(x,M){const q=n[x];if(M===q)return 0;const D=e.totalWeight,P=e.strengthOut[x],U=e.strengthIn[x],K=M<v.length&&v[M]||0,ue=M<m.length&&m[M]||0,ne=v[q]||0,fe=m[q]||0,H=M<h.length?h[M]:0,j=M<c.length?c[M]:0,L=h[q],k=c[q],G=(K+ue-ne-fe)/D,Z=(P*(H-L)+U*(j-k))/(D*D);return G-Z}function z(x,M,q=1){const D=n[x];if(M===D)return 0;const P=g[D]||0,U=M<g.length&&g[M]||0,K=e.size[x]||1,ue=o[D]||0,ne=M<o.length?o[M]:0;return U-P-q*K*(ne-ue+K)}function O(x,M){const q=n[x];if(q===M)return!1;M>=r&&(F(M+1),r=M+1);const D=e.strengthOut[x],P=e.strengthIn[x],U=e.selfLoop[x],K=e.size[x];if(u[q]-=1,u[M]+=1,o[q]-=K,o[M]+=K,e.directed?(c[q]-=D,c[M]+=D,h[q]-=P,h[M]+=P):(l[q]-=D,l[M]+=D),e.directed){const ue=m[q]||0,ne=v[q]||0,fe=M<m.length&&m[M]||0,H=M<v.length&&v[M]||0;s[q]-=ue+ne+U,s[M]+=fe+H+U}else{const ue=g[q]||0,ne=g[M]||0;s[q]-=2*ue+U,s[M]+=2*ne+U}return n[x]=M,!0}function Q(x={}){const M=[];for(let H=0;H<r;H++)u[H]>0&&M.push(H);x.keepOldOrder?M.sort((H,j)=>H-j):x.preserveMap instanceof Map?M.sort((H,j)=>{const L=x.preserveMap.get(H),k=x.preserveMap.get(j);return L!=null&&k!=null&&L!==k?L-k:L!=null&&k==null?-1:k!=null&&L==null?1:o[j]-o[H]||u[j]-u[H]||H-j}):M.sort((H,j)=>o[j]-o[H]||u[j]-u[H]||H-j);const q=new Int32Array(r).fill(-1);M.forEach((H,j)=>{q[H]=j});for(let H=0;H<n.length;H++)n[H]=q[n[H]];const D=M.length,P=new Float64Array(D),U=new Int32Array(D),K=new Float64Array(D),ue=new Float64Array(D),ne=new Float64Array(D),fe=new Float64Array(D);for(let H=0;H<t;H++){const j=n[H];P[j]+=e.size[H],U[j]+=1,e.directed?(ne[j]+=e.strengthOut[H],fe[j]+=e.strengthIn[H]):ue[j]+=e.strengthOut[H]}if(e.directed)for(let H=0;H<t;H++){const j=n[H],L=e.outEdges[H];for(let k=0;k<L.length;k++){const{to:G,w:Z}=L[k];j===n[G]&&(K[j]+=Z)}}else for(let H=0;H<t;H++){const j=n[H],L=e.outEdges[H];for(let k=0;k<L.length;k++){const{to:G,w:Z}=L[k];G<=H||j===n[G]&&(K[j]+=Z)}}r=D,o=P,u=U,s=K,l=ue,c=ne,h=fe}function V(){const x=new Array(r);for(let M=0;M<r;M++)x[M]=[];for(let M=0;M<t;M++)x[n[M]].push(M);return x}function W(x){return x<o.length?o[x]:0}function Y(x){return x<u.length?u[x]:0}return{n:t,get communityCount(){return r},nodeCommunity:n,communityTotalSize:o,communityNodeCount:u,communityInternalEdgeWeight:s,communityTotalStrength:l,communityTotalOutStrength:c,communityTotalInStrength:h,initializeAggregates:B,accumulateNeighborCommunityEdgeWeights:N,getCandidateCommunityCount:()=>A,getCandidateCommunityAt:x=>f[x],getNeighborEdgeWeightToCommunity:x=>g[x]||0,getOutEdgeWeightToCommunity:x=>m[x]||0,getInEdgeWeightFromCommunity:x=>v[x]||0,deltaModularityUndirected:y,deltaModularityDirected:I,deltaCPM:z,moveNodeToCommunity:O,compactCommunityIds:Q,getCommunityMembers:V,getCommunityTotalSize:W,getCommunityNodeCount:Y}}function tt(e,t){const n=new Float64Array(t);return n.set(e),n}function ma(e,t){const n=new Int32Array(t);return n.set(e),n}var va=au();const Ur=it(va);var Ea=Vr();const pa=it(Ea);function Ca(e,t,n,r){if(t.directed)return Wr(e,t,n,r);const o=e.nodeCommunity[n];if(r===o)return 0;const u=t.strengthOut[n],s=t.totalWeight,l=e.getNeighborEdgeWeightToCommunity(r)||0,c=e.getNeighborEdgeWeightToCommunity(o)||0,h=r<e.communityTotalStrength.length?e.communityTotalStrength[r]:0,f=e.communityTotalStrength[o],A=-(c/s-u*f/(s*s)),g=l/s-u*h/(s*s);return A+g}function Wr(e,t,n,r){const o=e.nodeCommunity[n];if(r===o)return 0;const u=t.totalWeight,s=t.strengthOut[n],l=t.strengthIn[n],c=r<t.n&&e.getInEdgeWeightFromCommunity(r)||0,h=r<t.n&&e.getOutEdgeWeightToCommunity(r)||0,f=e.getInEdgeWeightFromCommunity(o)||0,A=e.getOutEdgeWeightToCommunity(o)||0,g=r<e.communityTotalInStrength.length?e.communityTotalInStrength[r]:0,m=r<e.communityTotalOutStrength.length?e.communityTotalOutStrength[r]:0,v=e.communityTotalInStrength[o],E=e.communityTotalOutStrength[o],F=(c+h-f-A)/u,B=(s*(g-v)+l*(m-E))/(u*u);return F-B}function Fa(e,t){const n=t.totalWeight;let r=0;if(t.directed)for(let o=0;o<e.communityCount;o++)r+=e.communityInternalEdgeWeight[o]/n-e.communityTotalOutStrength[o]*e.communityTotalInStrength[o]/(n*n);else for(let o=0;o<e.communityCount;o++){const u=e.communityInternalEdgeWeight[o],s=e.communityTotalStrength[o];r+=u/n-s*s/(n*n)}return r}function ya(e,t,n,r,o=1){const u=e.nodeCommunity[n];if(r===u)return 0;const s=e.getNeighborEdgeWeightToCommunity(u)||0,l=r<t.n&&e.getNeighborEdgeWeightToCommunity(r)||0,c=t.size[n]||1,h=e.communityTotalSize[u]||0,f=r<e.communityTotalSize.length?e.communityTotalSize[r]:0;return l-s-o*c*(f-h+c)}function Ba(e,t,n=1){let r=0;for(let o=0;o<e.communityCount;o++)r+=e.communityInternalEdgeWeight[o]-n*(e.communityNodeCount[o]*(e.communityNodeCount[o]-1))/2;return r}function Da(e,t,n=1){let r=0;for(let o=0;o<e.communityCount;o++){const u=e.communityTotalSize[o]||0;r+=e.communityInternalEdgeWeight[o]-n*(u*(u-1))/2}return r}const wa=50,Gr=20,Yr=1e-12,Le={Neighbors:0,All:1,RandomAny:2,RandomNeighbor:3};function xa(e,t={}){const n=Ta(t);let r=e;const o=[],u=pa(n.randomSeed),s=()=>u.nextDouble(),l=yr(r,{directed:n.directed,...t}),c=l.n,h=new Int32Array(c);for(let g=0;g<c;g++)h[g]=g;let f=null;if(n.fixedNodes){const g=new Uint8Array(c),m=n.fixedNodes instanceof Set?n.fixedNodes:new Set(n.fixedNodes);for(const v of m){const E=l.idToIndex.get(v);E!=null&&(g[E]=1)}f=g}for(let g=0;g<n.maxLevels;g++){const m=g===0?l:yr(r,{directed:n.directed,...t}),v=jr(m);v.graph=m,v.initializeAggregates();const E=new Int32Array(m.n);for(let S=0;S<m.n;S++)E[S]=S;let F=!0,B=0;const b=n.candidateStrategyCode;for(;F;){F=!1,B++,Hr(E,s);for(let S=0;S<E.length;S++){const y=E[S];if(g===0&&f&&f[y])continue;const I=v.accumulateNeighborCommunityEdgeWeights(y);let z=v.nodeCommunity[y],O=0;const Q=n.maxCommunitySize;if(b===Le.All)for(let V=0;V<v.communityCount;V++){if(V===v.nodeCommunity[y]||Q<1/0&&v.getCommunityTotalSize(V)+m.size[y]>Q)continue;const W=Qe(v,y,V,n);W>O&&(O=W,z=V)}else if(b===Le.RandomAny){const V=Math.min(10,Math.max(1,v.communityCount));for(let W=0;W<V;W++){const Y=s()*v.communityCount|0;if(Y===v.nodeCommunity[y]||Q<1/0&&v.getCommunityTotalSize(Y)+m.size[y]>Q)continue;const x=Qe(v,y,Y,n);x>O&&(O=x,z=Y)}}else if(b===Le.RandomNeighbor){const V=Math.min(10,Math.max(1,I));for(let W=0;W<V;W++){const Y=v.getCandidateCommunityAt(s()*I|0);if(Y===v.nodeCommunity[y]||Q<1/0&&v.getCommunityTotalSize(Y)+m.size[y]>Q)continue;const x=Qe(v,y,Y,n);x>O&&(O=x,z=Y)}}else for(let V=0;V<I;V++){const W=v.getCandidateCommunityAt(V);if(Q<1/0&&v.getCommunityTotalSize(W)+m.size[y]>Q)continue;const Y=Qe(v,y,W,n);Y>O&&(O=Y,z=W)}if(n.allowNewCommunity){const V=v.communityCount,W=Qe(v,y,V,n);W>O&&(O=W,z=V)}z!==v.nodeCommunity[y]&&O>Yr&&(v.moveNodeToCommunity(y,z),F=!0)}if(B>n.maxLocalPasses)break}Br(v,n.preserveLabels);let w=v;if(n.refine){const S=$a(m,v,s,n,g===0?f:null);Br(S,n.preserveLabels),w=S}o.push({graph:m,partition:w});const N=w.nodeCommunity;for(let S=0;S<h.length;S++)h[S]=N[h[S]];if(v.communityCount===m.n)break;r=ba(m,w)}const A=o[o.length-1];return{graph:A.graph,partition:A.partition,levels:o,originalToCurrent:h,originalNodeIds:l.nodeIds}}function ba(e,t){const n=Ur();for(let o=0;o<t.communityCount;o++)n.addNode(o,{size:t.communityTotalSize[o]});const r=new Map;for(let o=0;o<e.n;o++){const u=t.nodeCommunity[o],s=e.outEdges[o];for(let l=0;l<s.length;l++){const c=s[l].to,h=s[l].w,f=t.nodeCommunity[c],A=u+":"+f;r.set(A,(r.get(A)||0)+h)}}for(const[o,u]of r.entries()){const[s,l]=o.split(":"),c=+s,h=+l;n.addLink(c,h,{weight:u})}return n}function $a(e,t,n,r,o){const u=jr(e);u.initializeAggregates(),u.graph=e;const s=t.nodeCommunity;let l=new Int32Array(u.communityCount);for(let A=0;A<u.communityCount;A++)l[A]=s[A];const c=new Int32Array(e.n);for(let A=0;A<e.n;A++)c[A]=A;let h=!0,f=0;for(;h;){h=!1,f++,Hr(c,n);for(let A=0;A<c.length;A++){const g=c[A];if(o&&o[g])continue;const m=s[g],v=u.accumulateNeighborCommunityEdgeWeights(g);let E=u.nodeCommunity[g],F=0;const B=Number.isFinite(r.maxCommunitySize)?r.maxCommunitySize:1/0;for(let b=0;b<v;b++){const w=u.getCandidateCommunityAt(b);if(l[w]!==m||B<1/0&&u.getCommunityTotalSize(w)+e.size[g]>B)continue;const N=Qe(u,g,w,r);N>F&&(F=N,E=w)}E!==u.nodeCommunity[g]&&F>Yr&&(u.moveNodeToCommunity(g,E),h=!0)}if(f>(r.maxLocalPasses||Gr))break}return u}function Qe(e,t,n,r){if((r.quality||"modularity").toLowerCase()==="cpm"){const u=typeof r.resolution=="number"?r.resolution:1;return ya(e,e.graph||{},t,n,u)||e.deltaCPM?.(t,n,u)||0}return r.directed?Wr(e,e.graph||{},t,n)||e.deltaModularityDirected?.(t,n)||0:Ca(e,e.graph||{},t,n)||e.deltaModularityUndirected?.(t,n)||0}function Hr(e,t=Math.random){for(let n=e.length-1;n>0;n--){const r=Math.floor(t()*(n+1)),o=e[n];e[n]=e[r],e[r]=o}return e}function Sa(e){const t=e.candidateStrategy;if(typeof t!="string")return Le.Neighbors;switch(t){case"neighbors":return Le.Neighbors;case"all":return Le.All;case"random":return Le.RandomAny;case"random-neighbor":return Le.RandomNeighbor;default:return Le.Neighbors}}function Ta(e={}){const t=!!e.directed,n=Number.isFinite(e.randomSeed)?e.randomSeed:42,r=Number.isFinite(e.maxLevels)?e.maxLevels:wa,o=Number.isFinite(e.maxLocalPasses)?e.maxLocalPasses:Gr,u=!!e.allowNewCommunity,s=Sa(e),l=(e.quality||"modularity").toLowerCase(),c=typeof e.resolution=="number"?e.resolution:1,h=e.refine!==!1,f=e.preserveLabels,A=Number.isFinite(e.maxCommunitySize)?e.maxCommunitySize:1/0;return{directed:t,randomSeed:n,maxLevels:r,maxLocalPasses:o,allowNewCommunity:u,candidateStrategyCode:s,quality:l,resolution:c,refine:h,preserveLabels:f,maxCommunitySize:A,fixedNodes:e.fixedNodes}}function Br(e,t){t&&t instanceof Map?e.compactCommunityIds({preserveMap:t}):t===!0?e.compactCommunityIds({keepOldOrder:!0}):e.compactCommunityIds()}function Ma(e,t={}){if(!Array.isArray(e)||e.length===0)throw new Error("layers must be a non-empty array");t.directed;const n=e[0].graph,r=[],o=new Set;n.forEachNode(c=>{r.push(c.id),o.add(c.id)});for(let c=1;c<e.length;c++)e[c].graph.forEachNode(f=>{if(!o.has(f.id))throw new Error("All layers must share identical node ids. Missing in base: "+f.id)});const u=Ur(),s=e[0].nodeSize||(c=>c.data&&typeof c.data.size=="number"?c.data.size:1);for(let c=0;c<r.length;c++){const h=r[c],f=n.getNode?n.getNode(h):null,A=f?s(f):1;u.addNode(h,{size:A})}const l=new Map;for(let c=0;c<e.length;c++){const{graph:h,weight:f=1,linkWeight:A}=e[c],g=A||(m=>m.data&&typeof m.data.weight=="number"?m.data.weight:1);h.forEachLink(m=>{const v=m.fromId,E=m.toId;if(!o.has(v)||!o.has(E))return;const F=f*g(m);if(F===0)return;const B=v+"\0"+E;l.set(B,(l.get(B)||0)+F)})}for(const[c,h]of l.entries()){const f=c.indexOf("\0"),A=c.substring(0,f),g=c.substring(f+1);u.addLink(A,g,{weight:h})}return u}function Ia(e,t={}){let n=e;Array.isArray(e)&&(n=Ma(e,{directed:!!t.directed}));const{graph:r,partition:o,levels:u,originalToCurrent:s,originalNodeIds:l}=xa(n,t),c=new Map;for(let h=0;h<l.length;h++){const f=s[h];c.set(l[h],f)}return{getClass(h){return c.get(h)},getCommunities(){const h=new Map;for(const[f,A]of c)h.has(A)||h.set(A,[]),h.get(A).push(f);return h},quality(){if((t.quality||"modularity").toLowerCase()==="cpm"){const f=typeof t.resolution=="number"?t.resolution:1;return(t.cpmMode||"unit")==="size-aware"?Da(o,r,f):Ba(o,r,f)}else return Fa(o,r)},toJSON(){const h={};for(const[f,A]of c)h[f]=A;return{membership:h,meta:{levels:u.length,quality:this.quality(),options:t}}}}}const Na=[255,3869180159,1454696959,10384383,4041491199,7516927,3579707647,3430524927].map(_a);function Ft(e,t={}){const{seedPalette:n=Na,saturation:r=.78,value:o=.98}=t,u=Array.from(e),s=new Map;for(let c=0;c<u.length&&c<n.length;c++)s.set(u[c],n[c]);const l=.6180339887498949;for(let c=n.length;c<u.length;c++){const h=c-n.length,f=Ht(.5+h*l),A=Dr(r+.15*(Ht(h*.37)-.5)),g=Dr(o-.12*Ht(h*.19)),m=Pa(f,A,g);s.set(u[c],m)}return s}function Pa(e,t=.8,n=1){const r=Math.floor(e*6),o=e*6-r,u=n*(1-t),s=n*(1-o*t),l=n*(1-(1-o)*t);let c,h,f;switch(r%6){case 0:c=n,h=l,f=u;break;case 1:c=s,h=n,f=u;break;case 2:c=u,h=n,f=l;break;case 3:c=u,h=s,f=n;break;case 4:c=l,h=u,f=n;break;case 5:c=n,h=u,f=s;break}const A=Math.round(c*255),g=Math.round(h*255),m=Math.round(f*255);return A<<24|g<<16|m<<8|255}function La(e){return new Set(e.values()).size}function Ht(e){return e-Math.floor(e)}function Dr(e){return e<0?0:e>1?1:e}function _a(e){const n=(e&255)!==0&&e>>>24!==0?e:e<<8|255,r=n>>>24&255,o=n>>>16&255,u=n>>>8&255;return r<<24|o<<16|u<<8|255}var Qt,wr;function ka(){if(wr)return Qt;wr=1;function e(r,o){function u(){this.constructor=r}u.prototype=o.prototype,r.prototype=new u}function t(r,o,u,s){this.message=r,this.expected=o,this.found=u,this.location=s,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}e(t,Error),t.buildMessage=function(r,o){var u={literal:function(g){return'"'+l(g.text)+'"'},class:function(g){var m="",v;for(v=0;v<g.parts.length;v++)m+=g.parts[v]instanceof Array?c(g.parts[v][0])+"-"+c(g.parts[v][1]):c(g.parts[v]);return"["+(g.inverted?"^":"")+m+"]"},any:function(g){return"any character"},end:function(g){return"end of input"},other:function(g){return g.description}};function s(g){return g.charCodeAt(0).toString(16).toUpperCase()}function l(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function c(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function h(g){return u[g.type](g)}function f(g){var m=new Array(g.length),v,E;for(v=0;v<g.length;v++)m[v]=h(g[v]);if(m.sort(),m.length>0){for(v=1,E=1;v<m.length;v++)m[v-1]!==m[v]&&(m[E]=m[v],E++);m.length=E}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function A(g){return g?'"'+l(g)+'"':"end of input"}return"Expected "+f(r)+" but "+A(o)+" found."};function n(r,o){o=o!==void 0?o:{};var u={},s={start:Mu},l=Mu,c="strict",h=ee("strict",!0),f="graph",A=ee("graph",!0),g="digraph",m=ee("digraph",!0),v="{",E=ee("{",!1),F="}",B=ee("}",!1),b=function(i,d,C,p){p===null&&(p=[]);var T={type:d.toLowerCase(),children:p};return i&&(T.strict=!0),C&&(T.id=C),T},w=";",N=ee(";",!1),S=function(i,d){return d},y=function(i,d){return[i].concat(d)},I="=",z=ee("=",!1),O=function(i,d){return{type:"attr_stmt",target:"graph",attr_list:[{type:"attr",id:i,eq:d}]}},Q="node",V=ee("node",!0),W="edge",Y=ee("edge",!0),x=function(i,d){return{type:"attr_stmt",target:i,attr_list:d}},M="[",q=ee("[",!1),D="]",P=ee("]",!1),U=function(i,d){return(i||[]).concat(d||[])},K=function(i,d){return d},ue=",",ne=ee(",",!1),fe=function(i,d,C){return[{type:"attr",id:i,eq:d}].concat(C||[])},H=function(i,d,C){var p=[i];return p=p.concat(d.map(function(T){return T.id})),{type:"edge_stmt",edge_list:p,attr_list:C||[]}},j="->",L=ee("->",!1),k="--",G=ee("--",!1),Z=function(i,d,C){return[{type:"edgeRHS",edgeop:i,id:d}].concat(C||[])},re=function(i,d){return{type:"node_stmt",node_id:i,attr_list:d||[]}},ie=function(i,d){return d?{type:"node_id",id:i,port:d}:{type:"node_id",id:i}},le=Ne("port"),we=":",Ie=ee(":",!1),J=function(i,d){return d},oe=function(i,d){return{type:"port",id:i,compass_pt:d||null}},pe=function(i){return{type:"port",compass_pt:i||null}},me="subgraph",xe=ee("subgraph",!0),Ke=function(i){return i?{type:"subgraph",id:i}:{type:"subgraph"}},ge=function(i,d){return i=i||{type:"subgraph"},i.children=d||[],i},Ze="n",Bt=ee("n",!1),fu="ne",en=ee("ne",!1),tn="e",un=ee("e",!1),du="se",rn=ee("se",!1),nn="s",on=ee("s",!1),hu="sw",an=ee("sw",!1),sn="w",cn=ee("w",!1),gu="nw",ln=ee("nw",!1),fn=Ne("UNICODE_STRING"),dn=function(i,d){return i+d.join("")},hn=function(i,d){return i+d},gn="$",An=ee("$",!1),mn="_",vn=ee("_",!1),En=Ne("NUMBER"),pn="-",Cn=ee("-",!1),Au=".",mu=ee(".",!1),Oe=/^[0-9]/,ze=Ce([["0","9"]],!1,!1),Fn=function(i){return parseFloat($u())},yn=function(i){return{type:"id",value:i.slice(1,i.length-1),html:!0}},Dt="<",wt=ee("<",!1),xt=">",bt=ee(">",!1),Bn=function(i){return"<"+i.join("")+">"},be=fi(),Ve=function(i){return i},Dn=function(i){return i.join("")},$t='"',St=ee('"',!1),wn=function(i){return i.join("")},xn=function(){return $u()},vu="\\",Eu=ee("\\",!1),bn=function(i){return i[1]==='"'?'"':i[0]+i[1]},$n=function(){return""},Sn=/^[\n\r\u2028\u2029]/,Tn=Ce([`
`,"\r","\u2028","\u2029"],!1,!1),Mn=Ne("end of line"),In=`
`,Nn=ee(`
`,!1),pu=`\r
`,Pn=ee(`\r
`,!1),Ln="\r",_n=ee("\r",!1),kn="\u2028",Rn=ee("\u2028",!1),qn="\u2029",On=ee("\u2029",!1),zn=Ne("COMMENT"),Vn=Ne("BLOCK_COMMENT"),Cu="/*",jn=ee("/*",!1),je="*/",Tt=ee("*/",!1),Fu=function(i){return i},Un=function(i){return i.join("")},Wn=Ne("C_COMMENT"),yu="//",Gn=ee("//",!1),Ue=/^[\n]/,We=Ce([`
`],!1,!1),Bu=function(i){return i.join("")},Yn=Ne("MACRO_COMMENT"),Hn="#",Qn=ee("#",!1),Xn=Ne("WHITESPACE"),Du=/^[\n\r]/,wu=Ce([`
`,"\r"],!1,!1),xu=/^[ \t]/,bu=Ce([" ","	"],!1,!1),Kn=/^[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137-\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148-\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C-\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA-\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9-\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC-\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF-\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F-\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0-\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB-\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE-\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0561-\u0587\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6-\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FC7\u1FD0-\u1FD3\u1FD6-\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6-\u1FF7\u210A\u210E-\u210F\u2113\u212F\u2134\u2139\u213C-\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65-\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73-\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3-\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7FA\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]/,Zn=Ce([["a","z"],"",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","",["",""],"","",["",""],"","","","","",["",""],"","","","",["",""],["",""],"","","","","","","","","","",["",""],"","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"",["",""],"","","","","",["",""],["",""],"","","",["",""],"",["",""],["",""],["",""],"","","","","","","","","","","",["",""],"","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","","","",["",""],["",""],"","",["",""],"",["",""],"","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","",["",""],["",""],["",""]],!1,!1),Jn=/^[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5-\u06E6\u07F4-\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C-\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D-\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA717-\uA71F\uA770\uA788\uA7F8-\uA7F9\uA9CF\uAA70\uAADD\uAAF3-\uAAF4\uFF70\uFF9E-\uFF9F]/,ei=Ce([["",""],["",""],["",""],"","","","","","",["",""],["",""],"","","","","","","","","","","",["",""],["",""],"",["",""],"","",["",""],["",""],"","","",["",""],"",["",""],["",""],"",["",""],"","",["",""],"","",["",""],"","","",["",""],"",["",""]],!1,!1),ti=/^[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0977\u0979-\u097F\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58-\u0C59\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E45\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A-\uA62B\uA66E\uA6A0-\uA6E5\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,ui=Ce(["","","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],"","",["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),ri=/^[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,ni=Ce(["","","","",["",""],["",""],["",""],"","",""],!1,!1),ii=/^[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178-\u0179\u017B\u017D\u0181-\u0182\u0184\u0186-\u0187\u0189-\u018B\u018E-\u0191\u0193-\u0194\u0196-\u0198\u019C-\u019D\u019F-\u01A0\u01A2\u01A4\u01A6-\u01A7\u01A9\u01AC\u01AE-\u01AF\u01B1-\u01B3\u01B5\u01B7-\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A-\u023B\u023D-\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u0386\u0388-\u038A\u038C\u038E-\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9-\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0-\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E-\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D-\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA\uFF21-\uFF3A]/,oi=Ce([["A","Z"],["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"","",["",""],["",""],"",["",""],"","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],"",["",""],"","","","","","","","",["",""],"",["",""],["",""],["",""],"",["",""],"","","","","","","","","","","","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],"","","","",["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],"",["",""],"","","",["",""],["",""],["",""],"","",["",""],"",["",""],"","","",["",""],"","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","",["",""]],!1,!1),ai=/^[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]/,si=Ce([["",""],["",""],["",""],"",["",""],["",""],["",""]],!1,!1),ci=/^[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/,li=Ce([["0","9"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),a=0,te=0,ot=[{line:1,column:1}],$e=0,Mt=[],$=0,at;if("startRule"in o){if(!(o.startRule in s))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');l=s[o.startRule]}function $u(){return r.substring(te,a)}function ee(i,d){return{type:"literal",text:i,ignoreCase:d}}function Ce(i,d,C){return{type:"class",parts:i,inverted:d,ignoreCase:C}}function fi(){return{type:"any"}}function di(){return{type:"end"}}function Ne(i){return{type:"other",description:i}}function Su(i){var d=ot[i],C;if(d)return d;for(C=i-1;!ot[C];)C--;for(d=ot[C],d={line:d.line,column:d.column};C<i;)r.charCodeAt(C)===10?(d.line++,d.column=1):d.column++,C++;return ot[i]=d,d}function Tu(i,d){var C=Su(i),p=Su(d);return{start:{offset:i,line:C.line,column:C.column},end:{offset:d,line:p.line,column:p.column}}}function R(i){a<$e||(a>$e&&($e=a,Mt=[]),Mt.push(i))}function hi(i,d,C){return new t(t.buildMessage(i,d),i,d,C)}function Mu(){var i,d;if(i=[],d=Iu(),d!==u)for(;d!==u;)i.push(d),d=Iu();else i=u;return i}function Iu(){var i,d,C,p,T,_,X,se,ce,Te,ve,_t,Gu;return i=a,d=ae(),d!==u?(r.substr(a,6).toLowerCase()===c?(C=r.substr(a,6),a+=6):(C=u,$===0&&R(h)),C===u&&(C=null),C!==u?(p=ae(),p!==u?(r.substr(a,5).toLowerCase()===f?(T=r.substr(a,5),a+=5):(T=u,$===0&&R(A)),T===u&&(r.substr(a,7).toLowerCase()===g?(T=r.substr(a,7),a+=7):(T=u,$===0&&R(m))),T!==u?(_=ae(),_!==u?(X=Se(),X===u&&(X=null),X!==u?(se=ae(),se!==u?(r.charCodeAt(a)===123?(ce=v,a++):(ce=u,$===0&&R(E)),ce!==u?(Te=Nu(),Te===u&&(Te=null),Te!==u?(ve=ae(),ve!==u?(r.charCodeAt(a)===125?(_t=F,a++):(_t=u,$===0&&R(B)),_t!==u?(Gu=ae(),Gu!==u?(te=i,d=b(C,T,X,Te),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i}function Nu(){var i,d,C,p,T,_,X,se,ce,Te,ve;if(i=a,d=ae(),d!==u)if(C=It(),C!==u)if(p=ae(),p!==u)if(r.charCodeAt(a)===59?(T=w,a++):(T=u,$===0&&R(N)),T===u&&(T=null),T!==u){for(_=[],X=a,se=ae(),se!==u?(ce=It(),ce!==u?(Te=ae(),Te!==u?(r.charCodeAt(a)===59?(ve=w,a++):(ve=u,$===0&&R(N)),ve===u&&(ve=null),ve!==u?(te=X,se=S(C,ce),X=se):(a=X,X=u)):(a=X,X=u)):(a=X,X=u)):(a=X,X=u);X!==u;)_.push(X),X=a,se=ae(),se!==u?(ce=It(),ce!==u?(Te=ae(),Te!==u?(r.charCodeAt(a)===59?(ve=w,a++):(ve=u,$===0&&R(N)),ve===u&&(ve=null),ve!==u?(te=X,se=S(C,ce),X=se):(a=X,X=u)):(a=X,X=u)):(a=X,X=u)):(a=X,X=u);_!==u?(te=i,d=y(C,_),i=d):(a=i,i=u)}else a=i,i=u;else a=i,i=u;else a=i,i=u;else a=i,i=u;return i}function It(){var i,d,C,p,T,_;return i=a,d=Se(),d!==u?(C=ae(),C!==u?(r.charCodeAt(a)===61?(p=I,a++):(p=u,$===0&&R(z)),p!==u?(T=ae(),T!==u?(_=Se(),_!==u?(te=i,d=O(d,_),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i===u&&(i=gi(),i===u&&(i=Ai(),i===u&&(i=Pt(),i===u&&(i=mi(),i===u&&(i=a,d=Se(),d!==u?(r.charCodeAt(a)===61?(C=I,a++):(C=u,$===0&&R(z)),C!==u?(p=Se(),p!==u?(d=[d,C,p],i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)))))),i}function gi(){var i,d,C;return i=a,r.substr(a,5).toLowerCase()===f?(d=r.substr(a,5),a+=5):(d=u,$===0&&R(A)),d===u&&(r.substr(a,4).toLowerCase()===Q?(d=r.substr(a,4),a+=4):(d=u,$===0&&R(V)),d===u&&(r.substr(a,4).toLowerCase()===W?(d=r.substr(a,4),a+=4):(d=u,$===0&&R(Y)))),d!==u?(C=st(),C!==u?(te=i,d=x(d,C),i=d):(a=i,i=u)):(a=i,i=u),i}function st(){var i,d,C,p,T,_,X,se,ce;return i=a,d=ae(),d!==u?(r.charCodeAt(a)===91?(C=M,a++):(C=u,$===0&&R(q)),C!==u?(p=ae(),p!==u?(T=Pu(),T===u&&(T=null),T!==u?(_=ae(),_!==u?(r.charCodeAt(a)===93?(X=D,a++):(X=u,$===0&&R(P)),X!==u?(se=ae(),se!==u?(ce=st(),ce===u&&(ce=null),ce!==u?(te=i,d=U(T,ce),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i}function Pu(){var i,d,C,p,T,_,X,se;return i=a,d=ae(),d!==u?(C=Se(),C!==u?(p=a,T=ae(),T!==u?(r.charCodeAt(a)===61?(_=I,a++):(_=u,$===0&&R(z)),_!==u?(X=ae(),X!==u?(se=Se(),se!==u?(te=p,T=K(C,se),p=T):(a=p,p=u)):(a=p,p=u)):(a=p,p=u)):(a=p,p=u),p===u&&(p=null),p!==u?(T=ae(),T!==u?(r.charCodeAt(a)===44?(_=ue,a++):(_=u,$===0&&R(ne)),_===u&&(r.charCodeAt(a)===59?(_=w,a++):(_=u,$===0&&R(N))),_===u&&(_=null),_!==u?(X=Pu(),X===u&&(X=null),X!==u?(te=i,d=fe(C,p,X),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i}function Ai(){var i,d,C,p;return i=a,d=Pt(),d===u&&(d=Nt()),d!==u?(C=Lu(),C!==u?(p=st(),p===u&&(p=null),p!==u?(te=i,d=H(d,C,p),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i}function Lu(){var i,d,C,p,T,_,X;return i=a,d=ae(),d!==u?(r.substr(a,2)===j?(C=j,a+=2):(C=u,$===0&&R(L)),C===u&&(r.substr(a,2)===k?(C=k,a+=2):(C=u,$===0&&R(G))),C!==u?(p=ae(),p!==u?(T=Pt(),T===u&&(T=Nt()),T!==u?(_=ae(),_!==u?(X=Lu(),X===u&&(X=null),X!==u?(te=i,d=Z(C,T,X),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i}function mi(){var i,d,C;return i=a,d=Nt(),d!==u?(C=st(),C===u&&(C=null),C!==u?(te=i,d=re(d,C),i=d):(a=i,i=u)):(a=i,i=u),i}function Nt(){var i,d,C;return i=a,d=Se(),d!==u?(C=vi(),C===u&&(C=null),C!==u?(te=i,d=ie(d,C),i=d):(a=i,i=u)):(a=i,i=u),i}function vi(){var i,d,C,p,T,_;return $++,i=a,r.charCodeAt(a)===58?(d=we,a++):(d=u,$===0&&R(Ie)),d!==u?(C=Se(),C!==u?(p=a,r.charCodeAt(a)===58?(T=we,a++):(T=u,$===0&&R(Ie)),T!==u?(_=_u(),_!==u?(te=p,T=J(C,_),p=T):(a=p,p=u)):(a=p,p=u),p===u&&(p=null),p!==u?(te=i,d=oe(C,p),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i===u&&(i=a,r.charCodeAt(a)===58?(d=we,a++):(d=u,$===0&&R(Ie)),d!==u?(C=_u(),C!==u?(te=i,d=pe(C),i=d):(a=i,i=u)):(a=i,i=u)),$--,i===u&&(d=u,$===0&&R(le)),i}function Pt(){var i,d,C,p,T,_;return i=a,d=a,r.substr(a,8).toLowerCase()===me?(C=r.substr(a,8),a+=8):(C=u,$===0&&R(xe)),C!==u?(p=ae(),p!==u?(T=Se(),T===u&&(T=null),T!==u?(_=ae(),_!==u?(te=d,C=Ke(T),d=C):(a=d,d=u)):(a=d,d=u)):(a=d,d=u)):(a=d,d=u),d===u&&(d=null),d!==u?(r.charCodeAt(a)===123?(C=v,a++):(C=u,$===0&&R(E)),C!==u?(p=Nu(),p===u&&(p=null),p!==u?(T=ae(),T!==u?(r.charCodeAt(a)===125?(_=F,a++):(_=u,$===0&&R(B)),_!==u?(te=i,d=ge(d,p),i=d):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u)):(a=i,i=u),i}function _u(){var i;return r.charCodeAt(a)===110?(i=Ze,a++):(i=u,$===0&&R(Bt)),i===u&&(r.substr(a,2)===fu?(i=fu,a+=2):(i=u,$===0&&R(en)),i===u&&(r.charCodeAt(a)===101?(i=tn,a++):(i=u,$===0&&R(un)),i===u&&(r.substr(a,2)===du?(i=du,a+=2):(i=u,$===0&&R(rn)),i===u&&(r.charCodeAt(a)===115?(i=nn,a++):(i=u,$===0&&R(on)),i===u&&(r.substr(a,2)===hu?(i=hu,a+=2):(i=u,$===0&&R(an)),i===u&&(r.charCodeAt(a)===119?(i=sn,a++):(i=u,$===0&&R(cn)),i===u&&(r.substr(a,2)===gu?(i=gu,a+=2):(i=u,$===0&&R(ln))))))))),i}function Se(){var i;return i=ku(),i===u&&(i=Ei(),i===u&&(i=Ou(),i===u&&(i=Ci(),i===u&&(i=pi())))),i}function ku(){var i,d,C,p;if($++,i=a,d=Ru(),d!==u){for(C=[],p=qu();p!==u;)C.push(p),p=qu();C!==u?(te=i,d=dn(d,C),i=d):(a=i,i=u)}else a=i,i=u;return $--,i===u&&(d=u,$===0&&R(fn)),i}function Ei(){var i,d,C;return i=a,d=Ou(),d!==u?(C=ku(),C!==u?(te=i,d=hn(d,C),i=d):(a=i,i=u)):(a=i,i=u),i}function Ru(){var i;return i=Si(),i===u&&(r.charCodeAt(a)===36?(i=gn,a++):(i=u,$===0&&R(An)),i===u&&(r.charCodeAt(a)===95?(i=mn,a++):(i=u,$===0&&R(vn)))),i}function qu(){var i;return i=Ru(),i===u&&(i=_i()),i}function Ou(){var i,d,C,p,T,_,X,se,ce;if($++,i=a,d=a,r.charCodeAt(a)===45?(C=pn,a++):(C=u,$===0&&R(Cn)),C===u&&(C=null),C!==u){if(p=a,r.charCodeAt(a)===46?(T=Au,a++):(T=u,$===0&&R(mu)),T!==u){if(_=[],Oe.test(r.charAt(a))?(X=r.charAt(a),a++):(X=u,$===0&&R(ze)),X!==u)for(;X!==u;)_.push(X),Oe.test(r.charAt(a))?(X=r.charAt(a),a++):(X=u,$===0&&R(ze));else _=u;_!==u?(T=[T,_],p=T):(a=p,p=u)}else a=p,p=u;if(p===u){if(p=a,T=[],Oe.test(r.charAt(a))?(_=r.charAt(a),a++):(_=u,$===0&&R(ze)),_!==u)for(;_!==u;)T.push(_),Oe.test(r.charAt(a))?(_=r.charAt(a),a++):(_=u,$===0&&R(ze));else T=u;if(T!==u){if(_=a,r.charCodeAt(a)===46?(X=Au,a++):(X=u,$===0&&R(mu)),X!==u){for(se=[],Oe.test(r.charAt(a))?(ce=r.charAt(a),a++):(ce=u,$===0&&R(ze));ce!==u;)se.push(ce),Oe.test(r.charAt(a))?(ce=r.charAt(a),a++):(ce=u,$===0&&R(ze));se!==u?(X=[X,se],_=X):(a=_,_=u)}else a=_,_=u;_===u&&(_=null),_!==u?(T=[T,_],p=T):(a=p,p=u)}else a=p,p=u}p!==u?(C=[C,p],d=C):(a=d,d=u)}else a=d,d=u;return d!==u&&(te=i,d=Fn()),i=d,$--,i===u&&(d=u,$===0&&R(En)),i}function pi(){var i,d;return i=a,d=Lt(),d!==u&&(te=i,d=yn(d)),i=d,i}function Lt(){var i,d,C,p;if(i=a,r.charCodeAt(a)===60?(d=Dt,a++):(d=u,$===0&&R(wt)),d!==u){for(C=[],p=zu(),p===u&&(p=Lt());p!==u;)C.push(p),p=zu(),p===u&&(p=Lt());C!==u?(r.charCodeAt(a)===62?(p=xt,a++):(p=u,$===0&&R(bt)),p!==u?(te=i,d=Bn(C),i=d):(a=i,i=u)):(a=i,i=u)}else a=i,i=u;return i}function zu(){var i,d,C,p,T;if(i=a,d=[],C=a,p=a,$++,r.charCodeAt(a)===62?(T=xt,a++):(T=u,$===0&&R(bt)),T===u&&(r.charCodeAt(a)===60?(T=Dt,a++):(T=u,$===0&&R(wt))),$--,T===u?p=void 0:(a=p,p=u),p!==u?(r.length>a?(T=r.charAt(a),a++):(T=u,$===0&&R(be)),T!==u?(te=C,p=Ve(T),C=p):(a=C,C=u)):(a=C,C=u),C!==u)for(;C!==u;)d.push(C),C=a,p=a,$++,r.charCodeAt(a)===62?(T=xt,a++):(T=u,$===0&&R(bt)),T===u&&(r.charCodeAt(a)===60?(T=Dt,a++):(T=u,$===0&&R(wt))),$--,T===u?p=void 0:(a=p,p=u),p!==u?(r.length>a?(T=r.charAt(a),a++):(T=u,$===0&&R(be)),T!==u?(te=C,p=Ve(T),C=p):(a=C,C=u)):(a=C,C=u);else d=u;return d!==u&&(te=i,d=Dn(d)),i=d,i}function Ci(){var i,d,C,p;if(i=a,r.charCodeAt(a)===34?(d=$t,a++):(d=u,$===0&&R(St)),d!==u){for(C=[],p=Vu();p!==u;)C.push(p),p=Vu();C!==u?(r.charCodeAt(a)===34?(p=$t,a++):(p=u,$===0&&R(St)),p!==u?(te=i,d=wn(C),i=d):(a=i,i=u)):(a=i,i=u)}else a=i,i=u;return i}function Vu(){var i,d,C;return i=Fi(),i===u&&(i=a,d=a,$++,r.charCodeAt(a)===34?(C=$t,a++):(C=u,$===0&&R(St)),C===u&&(C=Bi()),$--,C===u?d=void 0:(a=d,d=u),d!==u?(C=wi(),C!==u?(te=i,d=xn(),i=d):(a=i,i=u)):(a=i,i=u),i===u&&(i=yi())),i}function Fi(){var i,d,C,p;return i=a,d=a,r.charCodeAt(a)===92?(C=vu,a++):(C=u,$===0&&R(Eu)),C!==u?(r.length>a?(p=r.charAt(a),a++):(p=u,$===0&&R(be)),p!==u?(C=[C,p],d=C):(a=d,d=u)):(a=d,d=u),d!==u&&(te=i,d=bn(d)),i=d,i}function yi(){var i,d,C;return i=a,r.charCodeAt(a)===92?(d=vu,a++):(d=u,$===0&&R(Eu)),d!==u?(C=Di(),C!==u?(te=i,d=$n(),i=d):(a=i,i=u)):(a=i,i=u),i}function Bi(){var i;return Sn.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(Tn)),i}function Di(){var i;return $++,r.charCodeAt(a)===10?(i=In,a++):(i=u,$===0&&R(Nn)),i===u&&(r.substr(a,2)===pu?(i=pu,a+=2):(i=u,$===0&&R(Pn)),i===u&&(r.charCodeAt(a)===13?(i=Ln,a++):(i=u,$===0&&R(_n)),i===u&&(r.charCodeAt(a)===8232?(i=kn,a++):(i=u,$===0&&R(Rn)),i===u&&(r.charCodeAt(a)===8233?(i=qn,a++):(i=u,$===0&&R(On)))))),$--,i===u&&$===0&&R(Mn),i}function wi(){var i;return r.length>a?(i=r.charAt(a),a++):(i=u,$===0&&R(be)),i}function ju(){var i;return $++,i=xi(),i===u&&(i=bi(),i===u&&(i=$i())),$--,i===u&&$===0&&R(zn),i}function xi(){var i,d,C,p,T,_;if($++,i=a,r.substr(a,2)===Cu?(d=Cu,a+=2):(d=u,$===0&&R(jn)),d!==u){for(C=[],p=a,T=a,$++,r.substr(a,2)===je?(_=je,a+=2):(_=u,$===0&&R(Tt)),$--,_===u?T=void 0:(a=T,T=u),T!==u?(r.length>a?(_=r.charAt(a),a++):(_=u,$===0&&R(be)),_!==u?(te=p,T=Fu(_),p=T):(a=p,p=u)):(a=p,p=u);p!==u;)C.push(p),p=a,T=a,$++,r.substr(a,2)===je?(_=je,a+=2):(_=u,$===0&&R(Tt)),$--,_===u?T=void 0:(a=T,T=u),T!==u?(r.length>a?(_=r.charAt(a),a++):(_=u,$===0&&R(be)),_!==u?(te=p,T=Fu(_),p=T):(a=p,p=u)):(a=p,p=u);C!==u?(r.substr(a,2)===je?(p=je,a+=2):(p=u,$===0&&R(Tt)),p!==u?(te=i,d=Un(C),i=d):(a=i,i=u)):(a=i,i=u)}else a=i,i=u;return $--,i===u&&(d=u,$===0&&R(Vn)),i}function bi(){var i,d,C,p,T,_;if($++,i=a,r.substr(a,2)===yu?(d=yu,a+=2):(d=u,$===0&&R(Gn)),d!==u){for(C=[],p=a,T=a,$++,Ue.test(r.charAt(a))?(_=r.charAt(a),a++):(_=u,$===0&&R(We)),$--,_===u?T=void 0:(a=T,T=u),T!==u?(r.length>a?(_=r.charAt(a),a++):(_=u,$===0&&R(be)),_!==u?(te=p,T=Ve(_),p=T):(a=p,p=u)):(a=p,p=u);p!==u;)C.push(p),p=a,T=a,$++,Ue.test(r.charAt(a))?(_=r.charAt(a),a++):(_=u,$===0&&R(We)),$--,_===u?T=void 0:(a=T,T=u),T!==u?(r.length>a?(_=r.charAt(a),a++):(_=u,$===0&&R(be)),_!==u?(te=p,T=Ve(_),p=T):(a=p,p=u)):(a=p,p=u);C!==u?(Ue.test(r.charAt(a))?(p=r.charAt(a),a++):(p=u,$===0&&R(We)),p===u&&(p=null),p!==u?(te=i,d=Bu(C),i=d):(a=i,i=u)):(a=i,i=u)}else a=i,i=u;return $--,i===u&&(d=u,$===0&&R(Wn)),i}function $i(){var i,d,C,p,T,_;if($++,i=a,r.charCodeAt(a)===35?(d=Hn,a++):(d=u,$===0&&R(Qn)),d!==u){for(C=[],p=a,T=a,$++,Ue.test(r.charAt(a))?(_=r.charAt(a),a++):(_=u,$===0&&R(We)),$--,_===u?T=void 0:(a=T,T=u),T!==u?(r.length>a?(_=r.charAt(a),a++):(_=u,$===0&&R(be)),_!==u?(te=p,T=Ve(_),p=T):(a=p,p=u)):(a=p,p=u);p!==u;)C.push(p),p=a,T=a,$++,Ue.test(r.charAt(a))?(_=r.charAt(a),a++):(_=u,$===0&&R(We)),$--,_===u?T=void 0:(a=T,T=u),T!==u?(r.length>a?(_=r.charAt(a),a++):(_=u,$===0&&R(be)),_!==u?(te=p,T=Ve(_),p=T):(a=p,p=u)):(a=p,p=u);C!==u?(Ue.test(r.charAt(a))?(p=r.charAt(a),a++):(p=u,$===0&&R(We)),p===u&&(p=null),p!==u?(te=i,d=Bu(C),i=d):(a=i,i=u)):(a=i,i=u)}else a=i,i=u;return $--,i===u&&(d=u,$===0&&R(Yn)),i}function ae(){var i,d;for($++,i=[],d=Wu(),d===u&&(d=ju());d!==u;)i.push(d),d=Wu(),d===u&&(d=ju());return $--,i===u&&(d=u,$===0&&R(Xn)),i}function Uu(){var i,d;if(i=[],Du.test(r.charAt(a))?(d=r.charAt(a),a++):(d=u,$===0&&R(wu)),d!==u)for(;d!==u;)i.push(d),Du.test(r.charAt(a))?(d=r.charAt(a),a++):(d=u,$===0&&R(wu));else i=u;return i}function Wu(){var i,d;if(i=[],xu.test(r.charAt(a))?(d=r.charAt(a),a++):(d=u,$===0&&R(bu)),d===u&&(d=Uu()),d!==u)for(;d!==u;)i.push(d),xu.test(r.charAt(a))?(d=r.charAt(a),a++):(d=u,$===0&&R(bu)),d===u&&(d=Uu());else i=u;return i}function Si(){var i;return i=Pi(),i===u&&(i=Ti(),i===u&&(i=Ni(),i===u&&(i=Mi(),i===u&&(i=Ii(),i===u&&(i=Li()))))),i}function Ti(){var i;return Kn.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(Zn)),i}function Mi(){var i;return Jn.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(ei)),i}function Ii(){var i;return ti.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(ui)),i}function Ni(){var i;return ri.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(ni)),i}function Pi(){var i;return ii.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(oi)),i}function Li(){var i;return ai.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(si)),i}function _i(){var i;return ci.test(r.charAt(a))?(i=r.charAt(a),a++):(i=u,$===0&&R(li)),i}if(at=l(),at!==u&&a===r.length)return at;throw at!==u&&a<r.length&&R(di()),hi(Mt,$e<r.length?r.charAt($e):null,$e<r.length?Tu($e,$e+1):Tu($e,$e))}return Qt={SyntaxError:t,parse:n},Qt}var Xt,xr;function Ra(){if(xr)return Xt;xr=1;var e=ka();return Xt=e.parse,Xt}var Kt,br;function qa(){if(br)return Kt;br=1,Kt=t;var e=Ra();function t(A,g){var m=e(A);if(m.length>1&&g!==void 0)throw new Error("Dot file contains multiple graphs. Cannot use `saveTo` in this case");return g||(g=au()()),n(g,m[0])}function n(A,g){return r(A,g),A}function r(A,g){var m=g.children;if(!m)return A;for(var v=[],E=0;E<m.length;++E){var F=m[E];F.type==="edge_stmt"?s(v,o(A,F)):F.type==="node_stmt"?s(v,u(A,F)):F.type==="subgraph"&&s(v,r(A,F))}return v}function o(A,g){var m=g.edge_list;if(m.length!==0){var v=m[0],E=[],F=l(A,v);s(E,F);for(var B=h(g.attr_list),b=1;b<m.length;++b){var w=l(A,m[b]);s(E,w),c(A,F,w,B),F=w}return E}}function u(A,g){return l(A,g.node_id,g.attr_list)}function s(A,g){for(var m=0;m<g.length;++m)A.push(g[m]);return A}function l(A,g,m){if(g.type==="node_id"){var v=f(h(m),A.getNode(g.id));return v?A.addNode(g.id,v):A.addNode(g.id),[g.id]}else if(g.type==="subgraph")return r(A,g)}function c(A,g,m,v){for(var E=0;E<g.length;++E)for(var F=0;F<m.length;++F)A.addLink(g[E],m[F],v)}function h(A){if(!(!A||!A.length)){for(var g=Object.create(null),m=0;m<A.length;++m){var v=A[m];if(!(v.type!=="attr"||v.id===void 0)){var E=v.eq[0]==="["&&v.eq[v.eq.length-1]==="]";if(E)try{var F=JSON.parse(v.eq);v.eq=F}catch{}g[v.id]=v.eq}}return g}}function f(A,g){return!g||!g.data?A:Object.assign(g.data,A)}return Kt}var Oa=qa();const za=it(Oa);class Va extends iu{constructor(t,n={}){const r=ru({gl:t,vertex:`
        uniform mat4 modelViewProjection;
        attribute float size;
        attribute vec3 position;
        attribute vec4 color;
        attribute vec2 point;
        varying vec4 vColor;
        varying vec2 vPoint;
        void main() {
          gl_Position = modelViewProjection * vec4(position + vec3(point * size, 0.), 1.0);
          vColor = color.abgr;
          vPoint = point;
        }
      `,fragment:`
        precision highp float;
        varying vec4 vColor;
        varying vec2 vPoint;
        void main() {
          float dist = length(vPoint);
          if (dist >= 0.5) discard;
          gl_FragColor = vColor;
        }
      `,attributes:{color:new Or},instanced:{point:new nu([-.5,-.5,-.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5])},preDrawHook(){return"gl.enable(gl.DEPTH_TEST); gl.depthFunc(gl.LEQUAL);"},postDrawHook(){return"gl.disable(gl.DEPTH_TEST);"}});super(r)}}class ja extends iu{constructor(t,n={}){const r=ru({gl:t,vertex:`
        uniform mat4 modelViewProjection;
        uniform float width;
        uniform vec2 resolution;
        attribute vec4 color;
        attribute vec3 from, to;
        attribute vec2 point;
        varying vec4 vColor;
        void main() {
          vec4 clip0 = modelViewProjection * vec4(from, 1.0);
          vec4 clip1 = modelViewProjection * vec4(to, 1.0);
          vec2 screen0 = resolution * (0.5 * clip0.xy/clip0.w + 0.5);
          vec2 screen1 = resolution * (0.5 * clip1.xy/clip1.w + 0.5);
          vec2 xBasis = normalize(screen1 - screen0);
          vec2 yBasis = vec2(-xBasis.y, xBasis.x);
          vec2 pt0 = screen0 + width * point.x * yBasis;
          vec2 pt1 = screen1 + width * point.x * yBasis;
          vec2 pt = mix(pt0, pt1, point.y);
          vec4 clip = mix(clip0, clip1, point.y);
          gl_Position = vec4(clip.w * (2.0 * pt/resolution - 1.0), clip.z, clip.w);
          vColor = color.abgr;
        }
      `,fragment:`
        precision highp float;
        varying vec4 vColor;
        void main() { gl_FragColor = vColor; }
      `,attributes:{color:new Or},instanced:{point:new nu([-.5,0,-.5,1,.5,1,-.5,0,.5,1,.5,0])}});super(r),this.width=n.width||2}draw(t,n){this.uniforms||(this.uniforms={modelViewProjection:this.modelViewProjection,width:this.width,resolution:[n.width,n.height]}),this.uniforms.resolution[0]=n.width,this.uniforms.resolution[1]=n.height,this.program.draw(this.uniforms)}}class Ua extends iu{constructor(t,n={}){t.getExtension("OES_standard_derivatives"),super(Wa(t,n)),this.isReady=!1,this.queue=[],this.fontSize=n.fontSize||1,this.fontInfo=null,this._sdfTextureChanged=!1;const r=n.fontPath||"fonts";fetch(`${r}/Roboto.json`,{mode:"cors"}).then(o=>o.json()).then(o=>{this.fontInfo=o,this.alphabet=new Map,o.chars.forEach(s=>{const l=String.fromCharCode(s.id);this.alphabet.set(l,s)});const u=this.msdfImage=new Image;u.crossOrigin="Anonymous",u.onload=()=>{this._sdfTextureChanged=!0,this.program.setTextureCanvas("msdf",this.msdfImage),this.isReady=!0,this.sdfTextureWidth=u.width,this.sdfTextureHeight=u.height,this.queue.forEach(s=>this.addText(s)),this.queue=[],this.scene&&this.scene.renderFrame()},u.src=`${r}/Roboto0.png`})}clear(){this.program.setCount(0)}draw(t,n){this.uniforms||(this.uniforms={modelViewProjection:this.modelViewProjection,color:[.9,.9,.9,1],bias:.5}),this.uniforms.color[0]=.2,this.uniforms.color[1]=.4,this.uniforms.color[2]=.8,this.uniforms.color[3]=.8,this.uniforms.bias=.35,this.program.draw(this.uniforms),this.uniforms.color[0]=.95,this.uniforms.color[1]=.95,this.uniforms.color[2]=.95,this.uniforms.color[3]=1,this.uniforms.bias=.5,this.program.draw(this.uniforms)}addText(t){if(!this.isReady){this.queue.push(t);return}let{text:n,x:r=0,y:o=0,z:u=0}=t;if(n===void 0)throw new Error("Text is not defined in "+t);let s=0,l=t.fontSize||this.fontSize;if(t.limit!==void 0){let f=0;for(let A of n){const g=this.alphabet.get(A);g&&(f+=g.xadvance)}f>0&&(l=t.limit*this.fontInfo.info.size/f)}const c=l/this.fontInfo.info.size;if(t.cx!==void 0){let f=0;for(let A of n){const g=this.alphabet.get(A);g&&(f+=g.xadvance)}s-=f*t.cx*c}t.cy!==void 0&&(o+=l*t.cy);const h=this.fontInfo&&this.fontInfo.info&&this.fontInfo.info.size||42;for(let f of n){const A=this.alphabet.get(f);A&&(this.add({position:[r+s,o-A.yoffset*c,u],charSize:[l*A.width/h,-l*A.height/h],texturePosition:[A.x/this.sdfTextureWidth,1-A.y/this.sdfTextureHeight,A.width/this.sdfTextureWidth,-A.height/this.sdfTextureHeight]}),s+=A.xadvance*c)}}}function Wa(e,t){return ru({capacity:t.capacity||1,buffer:t.buffer,debug:t.debug,gl:e,vertex:`
  uniform mat4 modelViewProjection;
  uniform vec4 color;

  // Position of the text character:
  attribute vec3 position;
  // Instanced quad coordinate:
  attribute vec2 point;
  attribute vec2 charSize;
  // [x, y, w, h] - of the character in the msdf texture.
  attribute vec4 texturePosition;

  varying vec2 vPoint;

  void main() {
    gl_Position = modelViewProjection * vec4(
      position + vec3(
        vec2(point.x, point.y) * charSize,
        position.z),
      1.);
    vPoint = texturePosition.xy + point * texturePosition.zw;
  }`,fragment:`
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
  precision highp float;
  varying vec2 vPoint;

  uniform vec4 color;
  uniform float bias;
  uniform sampler2D msdf;

  float median(float r, float g, float b) {
    return max(min(r, g), min(max(r, g), b));
  }

  void main() {
    vec3 sample = texture2D(msdf, vPoint).rgb;
    float sigDist = median(sample.r, sample.g, sample.b) - bias;
    float alpha = clamp(sigDist / fwidth(sigDist) + bias, 0.0, 1.0);
    gl_FragColor = vec4(color.rgb, color.a * alpha);
  }`,instanced:{point:new nu([0,0,1,0,1,1,1,1,0,0,0,1])}})}function Ga({container:e,onSelectCommunity:t,onSelectNode:n}){if(!e)throw new Error("container is required");let r=null,o=null,u=null,s=null,l=null,c=null,h=new Map;function f(){e.textContent="",r=null,o=null,u=null;const E=document.createElement("div");E.className="muted",E.textContent="No data yet. Detect communities to populate.",e.appendChild(E)}function A(E,F){if(!E||!F)return new Map;const B=F.getCommunities(),b=Array.from(B.keys()).sort((N,S)=>{const y=Number(N),I=Number(S),z=Number.isFinite(y),O=Number.isFinite(I);return z&&O?y-I:String(N).localeCompare(String(S))}),w=new Map;for(const N of b){const S=B.get(N).slice();S.sort((y,I)=>String(y).localeCompare(String(I))),w.set(N,S)}return w}function g(){e.textContent="";const E=document.createElement("details");E.open=!1;const F=document.createElement("summary");F.innerHTML='<span class="twisty"></span> graph',E.appendChild(F);const B=document.createElement("div");B.setAttribute("role","group");const b=document.createElement("div");b.style.display="flex",b.style.justifyContent="space-between",b.style.alignItems="center",b.style.margin="4px 0 8px";const w=document.createElement("span");w.className="muted",w.textContent=l==null?"No selection":`Selected: ${l}`,c=w;const N=document.createElement("button");if(N.type="button",N.textContent="Clear",N.className="btn",N.style.padding="2px 6px",N.style.fontSize="12px",N.addEventListener("click",()=>t&&t(null)),b.appendChild(w),b.appendChild(N),B.appendChild(b),!u||u.size===0){const S=document.createElement("div");S.className="muted",S.textContent="No communities yet.",B.appendChild(S)}else{h=new Map;for(const[S,y]of u){const I=document.createElement("details");I.open=!1;const z=document.createElement("summary"),O=s?.get(S),Q=O!=null?Ya(O):null;if(Q){const q=document.createElement("span");q.style.display="inline-block",q.style.width="10px",q.style.height="10px",q.style.borderRadius="2px",q.style.background=Q,q.style.marginRight="6px",q.style.verticalAlign="middle",q.style.border="1px solid #0006",z.appendChild(q)}const V=document.createElement("span");V.className="twisty",V.textContent="",z.appendChild(V),z.appendChild(document.createTextNode(" "));const W=document.createElement("span");W.textContent=`community ${String(S)}`,l!=null&&String(l)===String(S)&&(W.style.fontWeight="600",W.style.textDecoration="underline"),z.appendChild(W),z.appendChild(document.createTextNode(" "));const Y=document.createElement("span");Y.className="muted",Y.textContent=`(${y.length})`,z.appendChild(Y),z.addEventListener("click",q=>{if(t){const D=l!=null&&String(l)===String(S);t(D?null:S)}}),I.appendChild(z);const x=document.createElement("ul");let M=!1;I.addEventListener("toggle",()=>{if(V.textContent=I.open?"":"",I.open&&!M){for(const q of y){const D=document.createElement("li");D.textContent=String(q),D.style.cursor="pointer",D.addEventListener("click",P=>{P.stopPropagation(),n&&n(q)}),x.appendChild(D)}M=!0}}),I.appendChild(x),B.appendChild(I),h.set(String(S),{summary:z,title:W})}}E.appendChild(B),E.addEventListener("toggle",()=>{const S=F.querySelector(".twisty");S&&(S.textContent=E.open?"":"")}),e.appendChild(E)}function m({graph:E,clusters:F,colors:B,selected:b}){r=E||null,o=F||null,u=A(r,o),s=B||null,l=b??null,g()}f();function v(E){l=E??null,c&&(c.textContent=l==null?"No selection":`Selected: ${l}`);for(const[F,{title:B}]of h){const b=l!=null&&String(l)===String(F);B.style.fontWeight=b?"600":"",B.style.textDecoration=b?"underline":""}}return{update:m,clear:f,setSelected:v}}function Ya(e){const t=e>>>24&255,n=e>>>16&255,r=e>>>8&255,u=((e&255)/255).toFixed(3);return`rgba(${t}, ${n}, ${r}, ${u})`}let de=Aa.create();const Ha=document.getElementById("cnv");let Fe,ye,De,Me,Be,he=null,ke=null,Re=null,nt=32;function Qa(e){if(!Number.isFinite(e)||e<=0)return 64;const t=32*Math.sqrt(200/e);return Math.max(6,Math.min(64,Math.round(t)))&255}function pt(e){return(4294967040|e&255)>>>0}Ja(de);const Xa=document.getElementById("layoutBtn"),Ka=document.getElementById("detectBtn"),Za=document.getElementById("settingsToggle"),qe=document.getElementById("configForm");Za?.addEventListener("click",()=>{qe?.classList.toggle("hidden")});Xa.addEventListener("click",()=>{qe?.classList.contains("hidden")&&qe.classList.remove("hidden"),Xr(200)});Ka.addEventListener("click",()=>{qe?.classList.contains("hidden")&&qe.classList.remove("hidden"),cu(lu())});qe?.addEventListener("change",()=>{he&&cu(lu())});window.addEventListener("dragover",e=>{e.preventDefault()});window.addEventListener("drop",async e=>{e.preventDefault();const t=e.dataTransfer?.files?.[0];if(!t||!t.name.endsWith(".dot"))return;const n=await t.text(),r=za(n);Qr(r),qe?.classList.remove("hidden")});function Ja(e){Fe=Ho(Ha),Fe.setClearColor(12/255,41/255,82/255,1);const t=40;Fe.setViewBox({left:-t,top:-t,right:t,bottom:t}),Qr(e);const n=document.getElementById("communityTree");n&&(ke=Ga({container:n,onSelectCommunity:r=>es(r),onSelectNode:r=>ts(r)}),ke.update({graph:de,clusters:he,colors:Zr(),selected:Re})),requestAnimationFrame(Kr),Xr(300),cu(lu())}function Qr(e){if(Be&&Be.dispose?.(),De){try{Fe.removeChild(De)}catch{}De.dispose?.(),De=null}if(ye){try{Fe.removeChild(ye)}catch{}ye.dispose?.(),ye=null}if(Me){try{Fe.removeChild(Me)}catch{}Me.dispose?.(),Me=null}de=e,nt=Qa(de.getLinksCount()),he=null,Re=null,Be=fa(de,{timeStep:.5,springLength:10,springCoefficient:.8,gravity:-12,dragCoefficient:.9}),Be.step();const t=Fe.getGL();ye=new Va(t,{capacity:de.getNodesCount()}),De=new ja(t,{capacity:de.getLinksCount()}),Me=new Ua(t,{fontSize:1,fontPath:"https://raw.githubusercontent.com/anvaka/graph-start/refs/heads/main/public/fonts"}),de.forEachNode(n=>{const r=Be.getNodePosition(n.id),o=2432236799,u=1;n.ui={position:[r.x,r.y,r.z||0],color:o,size:u},n.uiId=ye.add(n.ui)}),de.forEachLink(n=>{const r=Be.getNodePosition(n.fromId),o=Be.getNodePosition(n.toId),u=pt(nt);n.ui={from:[r.x,r.y,r.z||0],to:[o.x,o.y,o.z||0],color:u},n.uiId=De.add(n.ui)}),Fe.appendChild(De),Fe.appendChild(ye),Fe.appendChild(Me),su(),ke&&ke.update({graph:de,clusters:he,colors:null,selected:Re})}function Xr(e){for(let t=0;t<e;t++)Be.step()}function Kr(){requestAnimationFrame(Kr),de.forEachNode(e=>{const t=Be.getNodePosition(e.id),n=e.ui.position;n[0]=t.x,n[1]=t.y,n[2]=t.z||0,ye.update(e.uiId,e.ui)}),de.forEachLink(e=>{const t=Be.getNodePosition(e.fromId),n=Be.getNodePosition(e.toId),{from:r,to:o}=e.ui;r[0]=t.x,r[1]=t.y,r[2]=t.z||0,o[0]=n.x,o[1]=n.y,o[2]=n.z||0,De.update(e.uiId,e.ui)}),Me?.isReady&&su(),Fe.renderFrame()}function su(){if(!Me)return;Me.clear();const e=he;de.forEachNode(t=>{const n=t.ui?.position;if(!n)return;const r=e?e.getClass(t.id):null,o=r!=null?String(r):String(t.id),u=t.ui?.size||1;Me.addText({text:o,x:n[0],y:n[1]-u*.6,limit:u,cx:.5})})}function cu(e={}){const t=Ia(de,e);he=t;const n=t.getCommunities(),r=Ft(n.keys());de.forEachNode(s=>{const l=t.getClass(s.id);s.ui.color=r.get(l)||2432236799,ye.update(s.uiId,s.ui)}),su();const o=document.getElementById("qualityValue");o&&(o.textContent=Number(t.quality()).toFixed(6));const u=document.getElementById("communityStats");if(u){const s=La(r);u.textContent=`${n.size} communities  ${s} colors`}ke&&ke.update({graph:de,clusters:he,colors:Zr(),selected:Re}),Jr()}function Zr(){if(!he)return null;const e=he.getCommunities(),t=Ft(e.keys()),n=new Map;for(const r of e.keys())n.set(r,t.get(r));return n}function Jr(){if(!ye||!De)return;const e=Re;if(!he||e==null){if(!he)return;const u=he.getCommunities(),s=Ft(u.keys());de.forEachNode(l=>{const c=he.getClass(l.id);l.ui.color=s.get(c)||2432236799,ye.update(l.uiId,l.ui)}),de.forEachLink(l=>{l.ui.color=pt(nt),De.update(l.uiId,l.ui)});return}const t=2155905109,n=pt(Math.max(Math.round(nt*.5),4)),r=he.getCommunities(),o=Ft(r.keys());de.forEachNode(u=>{const s=he.getClass(u.id),l=String(s)===String(e);u.ui.color=l?o.get(s)||2432236799:t,ye.update(u.uiId,u.ui)}),de.forEachLink(u=>{const s=he.getClass(u.fromId),l=he.getClass(u.toId),c=String(s)===String(e)&&String(l)===String(e),h=Math.min(nt*2,128);u.ui.color=c?pt(h):n,De.update(u.uiId,u.ui)})}function es(e){Re=e??null,Jr(),ke&&ke.setSelected(Re)}function ts(e){const t=Be.getNodePosition(e);t&&Fe.flyTo({x:t.x,y:t.y,durationMs:350})}function lu(){const e=document.getElementById("configForm");if(!e)return{quality:"modularity"};const t=new FormData(e),n=t.get("quality")||"modularity",r=t.get("directed")==="on",o=t.get("refine")!=="off",u=t.get("allowNewCommunity")==="on",s=t.get("candidateStrategy")||"neighbors",l=t.get("maxCommunitySize"),c=t.get("resolution"),h=t.get("randomSeed"),f=t.get("cpmMode")||"unit",A=t.get("linkWeightExpr"),g=t.get("nodeSizeExpr"),m=t.get("maxLevels"),v=t.get("maxLocalPasses"),E={quality:String(n),directed:r,refine:o,allowNewCommunity:u,candidateStrategy:String(s)};if(c&&(E.resolution=Number(c)),h&&(E.randomSeed=Number(h)),l&&(E.maxCommunitySize=Number(l)),n==="cpm"&&f&&(E.cpmMode=String(f)),A)try{E.linkWeight=Function("l",`return (${A})(l)`)}catch{console.warn("Bad linkWeight fn")}if(g)try{E.nodeSize=Function("n",`return (${g})(n)`)}catch{console.warn("Bad nodeSize fn")}return m&&(E.maxLevels=Number(m)),v&&(E.maxLocalPasses=Number(v)),E}
